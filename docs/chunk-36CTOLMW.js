import{$ as X,$a as _t,A as ut,Aa as Lt,B as le,Ba as es,C as Fe,Ca as ts,D as ne,Da as yn,E as d,Ea as ns,F as p,Fa as Vt,G as m,Ga as Ze,H as Gr,Ha as is,I as Br,Ia as rs,J as F,Ja as ss,K as y,Ka as os,L as _,La as as,M as pn,Ma as ls,N as mn,Na as cs,O as T,Oa as li,P as fe,Q as oe,Qa as me,R as Hr,Ra as Ve,S as j,Sa as re,T as ie,Ta as je,U as A,Ua as ft,V as D,Va as Ge,Wa as W,X as Z,Xa as pt,Y as pe,Ya as ds,Z as Ur,Za as us,_ as _n,_a as mt,a as Re,ab as wn,b as ct,bb as xn,cb as bn,d as M,da as gn,db as Be,e as z,ea as Wr,fa as Le,g as Y,ga as zr,gb as Xe,hb as _e,i as Q,ia as g,j as V,ja as ht,jb as ge,ka as qr,kb as Ce,l as hn,la as Yr,lb as ve,ma as Kr,n as x,na as $r,o as b,oa as Cn,p as P,pa as Qr,q as ee,qa as oi,r as dt,ra as Zr,sa as Me,t as fn,ta as vn,u as C,ua as K,v as k,va as Xr,wa as Jr,xa as Te,y as I,ya as Qe,z as v,za as ai}from"./chunk-SCMEIW5N.js";var ce=(()=>{let e=class e{constructor(){this.notificationAdded=new z}push(i){this.notificationAdded.next(i)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var ya=n=>({background:n});function wa(n,e){if(n&1&&(d(0,"div",3),T(1),p()),n&2){let t=e.$implicit;le(ie(3,ya,t.success?"aquamarine":"lightcoral")),C(),fe(t.message)}}var hs=(()=>{let e=class e{constructor(i){this.notificationsService=i,this.notifications=[],this.timeout=1500}ngOnInit(){this.notificationsService.notificationAdded.subscribe(i=>this.handleNotification(i))}handleNotification(i){this.notifications.push(i),this.clearNext()}clearNext(){setTimeout(()=>this.notifications.splice(0,1),this.timeout)}};e.\u0275fac=function(r){return new(r||e)(k(ce))},e.\u0275cmp=V({type:e,selectors:[["app-notifications"]],standalone:!0,features:[j],decls:3,vars:1,consts:[[1,"container"],[1,"bubble-container"],["class","bubble",3,"style",4,"ngFor","ngForOf"],[1,"bubble"]],template:function(r,s){r&1&&(d(0,"div",0)(1,"div",1),I(2,wa,2,5,"div",2),p()()),r&2&&(C(2),v("ngForOf",s.notifications))},dependencies:[X,Z],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.container[_ngcontent-%COMP%]{position:absolute;z-index:12;top:0;left:0;width:100%;display:flex;flex-direction:row;justify-content:center}.bubble-container[_ngcontent-%COMP%]{display:flex;flex-direction:column-reverse;justify-content:center;margin-top:.5rem;gap:.5rem}.bubble[_ngcontent-%COMP%]{border-radius:16px;width:fit-content;padding:.25rem 1rem;box-shadow:0 1px 3px gray;margin:auto;font-size:20px}"]});let n=e;return n})();var xa=["*"],gt=(()=>{let e=class e{constructor(){this.close=new dt}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=V({type:e,selectors:[["app-modal"]],outputs:{close:"close"},standalone:!0,features:[j],ngContentSelectors:xa,decls:3,vars:0,consts:[[1,"background",3,"click"],[1,"content",3,"click"]],template:function(r,s){r&1&&(pn(),d(0,"div",0),y("click",function(){return s.close.emit()}),d(1,"div",1),y("click",function(a){return a.stopPropagation()}),mn(2),p()())},styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100vw;height:100vh;background:#80808080;z-index:10;display:flex;flex-direction:column;justify-content:center}.content[_ngcontent-%COMP%]{width:75%;height:80%;max-width:700px;z-index:11;display:flex;flex-direction:column;justify-content:space-between;text-align:center;background:#dedede;margin:auto;font-size:24px;box-shadow:0 1px 2px gray;border-radius:10px;padding:1rem}@media screen and (max-width: 500px),screen and (max-height: 800px){.content[_ngcontent-%COMP%]{width:85%;height:calc(100% - 5rem);margin:.5rem auto}.background[_ngcontent-%COMP%]{justify-content:flex-start}}"]});let n=e;return n})();var fs="@firebase/database",ps="1.0.5";var hr="";function ba(n){hr=n}var _i=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),K(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:vn(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var gi=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Te(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var zs=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new _i(e)}}catch{}return new gi},tt=zs("localStorage"),Ci=zs("sessionStorage");var yt=new ss("@firebase/database"),Sa=function(){let n=1;return function(){return n++}}(),qs=function(n){let e=ns(n),t=new ts;t.update(e);let i=t.digest();return qr.encodeByteArray(i)},tn=function(...n){let e="";for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=tn.apply(null,i):typeof i=="object"?e+=K(i):e+=i,e+=" "}return e},it=null,ms=!0,ka=function(n,e){g(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(yt.logLevel=rs.VERBOSE,it=yt.log.bind(yt),e&&Ci.set("logging_enabled",!0)):typeof n=="function"?it=n:(it=null,Ci.remove("logging_enabled"))},se=function(...n){if(ms===!0&&(ms=!1,it===null&&Ci.get("logging_enabled")===!0&&ka(!0)),it){let e=tn.apply(null,n);it(e)}},nn=function(n){return function(...e){se(n,...e)}},vi=function(...n){let e="FIREBASE INTERNAL ERROR: "+tn(...n);yt.error(e)},Ae=function(...n){let e=`FIREBASE FATAL ERROR: ${tn(...n)}`;throw yt.error(e),new Error(e)},de=function(...n){let e="FIREBASE WARNING: "+tn(...n);yt.warn(e)},Ma=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&de("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ys=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Ta=function(n){if(Me()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},xt="[MIN_NAME]",rt="[MAX_NAME]",Pt=function(n,e){if(n===e)return 0;if(n===xt||e===rt)return-1;if(e===xt||n===rt)return 1;{let t=_s(n),i=_s(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},Ea=function(n,e){return n===e?0:n<e?-1:1},jt=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+K(e))},fr=function(n){if(typeof n!="object"||n===null)return K(n);let e=[];for(let i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=K(e[i]),t+=":",t+=fr(n[e[i]]);return t+="}",t},Ks=function(n,e){let t=n.length;if(t<=e)return[n];let i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function ue(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var $s=function(n){g(!Ys(n),"Invalid JSON number");let e=11,t=52,i=(1<<e-1)-1,r,s,o,a,l;n===0?(s=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=a+i,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-i-t))));let c=[];for(l=t;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let u=c.join(""),h="";for(l=0;l<64;l+=8){let f=parseInt(u.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),h=h+f}return h.toLowerCase()},Pa=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Ia=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Oa(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}var Na=new RegExp("^-?(0*)\\d{1,10}$"),Ra=-2147483648,Fa=2147483647,_s=function(n){if(Na.test(n)){let e=Number(n);if(e>=Ra&&e<=Fa)return e}return null},It=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw de("Exception was thrown by user callback.",t),e},Math.floor(0))}},Aa=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Wt=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var yi=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){de(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var wi=class{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(se("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',de(e)}},zt=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),kn="5",Qs="v",Zs="s",Xs="r",Js="f",eo=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,to="ls",no="p",xi="ac",io="websocket",ro="long_polling";var Mn=class{constructor(e,t,i,r,s=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=tt.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&tt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function Da(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function so(n,e,t){g(typeof e=="string","typeof type must == string"),g(typeof t=="object","typeof params must == object");let i;if(e===io)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===ro)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Da(n)&&(t.ns=n.namespace);let r=[];return ue(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var bi=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Te(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Kr(this.counters_)}};var ci={},di={};function pr(n){let e=n.toString();return ci[e]||(ci[e]=new bi),ci[e]}function La(n,e){let t=n.toString();return di[t]||(di[t]=e()),di[t]}var Si=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&It(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var gs="start",Va="close",ja="pLPCommand",Ga="pRTLPCB",oo="id",ao="pw",lo="ser",Ba="cb",Ha="seg",Ua="ts",Wa="d",za="dframe",co=1870,uo=30,qa=co-uo,Ya=25e3,Ka=3e4,ki=class n{constructor(e,t,i,r,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=nn(e),this.stats_=pr(t),this.urlFn=l=>(this.appCheckToken&&(l[xi]=this.appCheckToken),so(t,ro,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Si(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Ka)),Ta(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Mi((...s)=>{let[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===gs)this.id=a,this.password=l;else if(o===Va)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[gs]="t",i[lo]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Ba]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Qs]=kn,this.transportSessionId&&(i[Zs]=this.transportSessionId),this.lastSessionId&&(i[to]=this.lastSessionId),this.applicationId&&(i[no]=this.applicationId),this.appCheckToken&&(i[xi]=this.appCheckToken),typeof location<"u"&&location.hostname&&eo.test(location.hostname)&&(i[Xs]=Js);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Me()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Pa()&&!Ia()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=K(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let i=Yr(t),r=Ks(i,qa);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Me())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[za]="t",i[oo]=e,i[ao]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=K(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},Mi=class n{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Me())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Sa(),window[ja+this.uniqueCallbackIdentifier]=e,window[Ga+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){se("frame writing exception"),a.stack&&se(a.stack),se(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||se("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[oo]=this.myID,e[ao]=this.myPW,e[lo]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+uo+i.length<=co;){let o=this.pendingSegs.shift();i=i+"&"+Ha+r+"="+o.seg+"&"+Ua+r+"="+o.ts+"&"+Wa+r+"="+o.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(Ya)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,t){Me()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{se("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var $a=16384,Qa=45e3,Tn=null;typeof MozWebSocket<"u"?Tn=MozWebSocket:typeof WebSocket<"u"&&(Tn=WebSocket);var Gt=(()=>{class n{constructor(t,i,r,s,o,a,l){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=nn(this.connId),this.stats_=pr(i),this.connURL=n.connectionURL_(i,a,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,o){let a={};return a[Qs]=kn,!Me()&&typeof location<"u"&&location.hostname&&eo.test(location.hostname)&&(a[Xs]=Js),i&&(a[Zs]=i),r&&(a[to]=r),s&&(a[xi]=s),o&&(a[no]=o),so(t,io,a)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,tt.set("previous_websocket_failure",!0);try{let r;if(Me()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${kn}/${hr}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new Tn(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&Tn!==null&&!n.forceDisallow_}static previouslyFailed(){return tt.isInMemoryStorage||tt.get("previous_websocket_failure")===!0}markConnectionHealthy(){tt.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=vn(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(g(this.frames===null,"We already have a frame buffer"),t.length<=6){let i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();let i=K(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=Ks(i,$a);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Qa))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),Za=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[ki,Gt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let i=Gt&&Gt.isAvailable(),r=i&&!Gt.previouslyFailed();if(t.webSocketOnly&&(i||de("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Gt];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),Xa=6e4,Ja=5e3,el=10*1024,tl=100*1024,ui="t",Cs="d",nl="s",vs="r",il="e",ys="o",ws="a",xs="n",bs="p",rl="h",Ti=class{constructor(e,t,i,r,s,o,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=nn("c:"+this.id+":"),this.transportManager_=new Za(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Wt(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>tl?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>el?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ui in e){let t=e[ui];t===ws?this.upgradeIfSecondaryHealthy_():t===vs?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===ys&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=jt("t",e),i=jt("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:bs,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:ws,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:xs,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=jt("t",e),i=jt("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=jt(ui,e);if(Cs in e){let i=e[Cs];if(t===rl){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===xs){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===nl?this.onConnectionShutdown_(i):t===vs?this.onReset_(i):t===il?vi("Server Error: "+i):t===ys?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):vi("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),kn!==i&&de("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Wt(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Xa))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Wt(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Ja))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:bs,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(tt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var En=class{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}};var Pn=class{constructor(e){this.allowedEvents_=e,this.listeners_={},g(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});let r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){g(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var In=class n extends Pn{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!oi()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return g(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Ss=32,ks=768,G=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function L(){return new G("")}function R(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function ze(n){return n.pieces_.length-n.pieceNum_}function U(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new G(n.pieces_,e)}function ho(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function sl(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function fo(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function po(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new G(e,0)}function $(n,e){let t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof G)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new G(t,0)}function N(n){return n.pieceNum_>=n.pieces_.length}function ae(n,e){let t=R(n),i=R(e);if(t===null)return e;if(t===i)return ae(U(n),U(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function mo(n,e){if(ze(n)!==ze(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Se(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(ze(n)>ze(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}var Ei=class{constructor(e,t){this.errorPrefix_=t,this.parts_=fo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Vt(this.parts_[i]);_o(this)}};function ol(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Vt(e),_o(n)}function al(n){let e=n.parts_.pop();n.byteLength_-=Vt(e),n.parts_.length>0&&(n.byteLength_-=1)}function _o(n){if(n.byteLength_>ks)throw new Error(n.errorPrefix_+"has a key path longer than "+ks+" bytes ("+n.byteLength_+").");if(n.parts_.length>Ss)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Ss+") or object contains a cycle "+et(n))}function et(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var Pi=class n extends Pn{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new n}getInitialEvent(e){return g(e==="visible","Unknown event type: "+e),[this.visible_]}};var Bt=1e3,ll=60*5*1e3,Ms=30*1e3,cl=1.3,dl=3e4,ul="server_kill",Ts=3,mr=(()=>{class n extends En{constructor(t,i,r,s,o,a,l,c){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=n.nextPersistentConnectionId_++,this.log_=nn("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Bt,this.maxReconnectDelay_=ll,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Me())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Pi.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&In.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){let s=++this.requestNumber_,o={r:s,a:t,b:i};this.log_(K(o)),g(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();let i=new Cn,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(t,i,r,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),g(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),g(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){let i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){let i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,u=l.s;n.warnOnListenWarnings_(c,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,s),t.onComplete&&t.onComplete(u,c))})}static warnOnListenWarnings_(t,i){if(t&&typeof t=="object"&&Te(t,"w")){let r=Qe(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();de(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||Jr(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Ms)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,i=Xr(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let i=t.s,r=t.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){let r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),g(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);let o={p:t},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(t){let i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+K(t));let i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),t==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):t==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):t==="c"?this.onListenRevoked_(i.p,i.q):t==="ac"?this.onAuthRevoked_(i.s,i.d):t==="apc"?this.onAppCheckRevoked_(i.s,i.d):t==="sd"?this.onSecurityDebugPacket_(i):vi("Unrecognized action received from server: "+K(t)+`
Are you using the latest client?`)}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){g(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Bt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Bt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>dl&&(this.reconnectDelay_=Bt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*cl)}this.onConnectStatus_(!1)}establishConnection_(){return M(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,r())},u=function(f){g(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(f)};this.realtime_={close:c,sendRequest:u};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[f,w]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?se("getToken() completed but was canceled"):(se("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=w&&w.token,l=new Ti(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,i,r,S=>{de(S+" ("+this.repoInfo_.toString()+")"),this.interrupt(ul)},o))}catch(f){this.log_("Failed to get token: "+f),a||(this.repoInfo_.nodeAdmin&&de(f),c())}}})}interrupt(t){se("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){se("Resuming connection for reason: "+t),delete this.interruptReasons_[t],ai(this.interruptReasons_)&&(this.reconnectDelay_=Bt,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let i=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;i?r=i.map(o=>fr(o)).join("$"):r="default";let s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){let r=new G(t).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){se("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ts&&(this.reconnectDelay_=Ms,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){se("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ts&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},i="js";Me()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),t["sdk."+i+"."+hr.replace(/\./g,"-")]=1,oi()?t["framework.cordova"]=1:Zr()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=In.getInstance().currentlyOnline();return ai(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),O=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var bt=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let i=new O(xt,e),r=new O(xt,t);return this.compare(i,r)!==0}minPost(){return O.MIN}};var Sn,On=class extends bt{static get __EMPTY_NODE(){return Sn}static set __EMPTY_NODE(e){Sn=e}compare(e,t){return Pt(e.name,t.name)}isDefinedOn(e){throw ht("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return O.MIN}maxPost(){return new O(rt,Sn)}makePost(e,t){return g(typeof e=="string","KeyIndex indexValue must always be a string."),new O(e,Sn)}toString(){return".key"}},wt=new On;var vt=class{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},be=(()=>{class n{constructor(t,i,r,s,o){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??ye.EMPTY_NODE,this.right=o??ye.EMPTY_NODE}copy(t,i,r,s,o){return new n(t??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this,o=r(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ye.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(t,r.key)===0){if(r.right.isEmpty())return ye.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),Ii=class{copy(e,t,i,r,s){return this}insert(e,t,i){return new be(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ye=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,be.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,be.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new vt(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new vt(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new vt(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new vt(this.root_,null,this.comparator_,!0,e)}};ye.EMPTY_NODE=new Ii;function hl(n,e){return Pt(n.name,e.name)}function _r(n,e){return Pt(n,e)}var Oi;function fl(n){Oi=n}var go=function(n){return typeof n=="number"?"number:"+$s(n):"string:"+n},Co=function(n){if(n.isLeafNode()){let e=n.val();g(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Te(e,".sv"),"Priority must be a string or number.")}else g(n===Oi||n.isEmpty(),"priority of unexpected type.");g(n===Oi||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Es,St=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,g(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Co(this.priorityNode_)}static set __childrenNodeConstructor(t){Es=t}static get __childrenNodeConstructor(){return Es}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return N(t)?this:R(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return t===".priority"?this.updatePriority(i):i.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){let r=R(t);return r===null?i:i.isEmpty()&&r!==".priority"?this:(g(r!==".priority"||ze(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(U(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+go(this.priorityNode_.val())+":");let i=typeof this.value_;t+=i+":",i==="number"?t+=$s(this.value_):t+=this.value_,this.lazyHash_=qs(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(g(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),o=n.VALUE_TYPE_ORDER.indexOf(r);return g(s>=0,"Unknown leaf type: "+i),g(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let i=t;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),vo,yo;function pl(n){vo=n}function ml(n){yo=n}var Ni=class extends bt{compare(e,t){let i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return s===0?Pt(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return O.MIN}maxPost(){return new O(rt,new St("[PRIORITY-POST]",yo))}makePost(e,t){let i=vo(e);return new O(t,new St("[PRIORITY-POST]",i))}toString(){return".priority"}},q=new Ni;var _l=Math.log(2),Ri=class{constructor(e){let t=s=>parseInt(Math.log(s)/_l,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Nn=function(n,e,t,i){n.sort(e);let r=function(l,c){let u=c-l,h,f;if(u===0)return null;if(u===1)return h=n[l],f=t?t(h):h,new be(f,h.node,be.BLACK,null,null);{let w=parseInt(u/2,10)+l,S=r(l,w),B=r(w+1,c);return h=n[w],f=t?t(h):h,new be(f,h.node,be.BLACK,S,B)}},s=function(l){let c=null,u=null,h=n.length,f=function(S,B){let te=h-S,lt=h;h-=S;let un=r(te+1,lt),si=n[te],va=t?t(si):si;w(new be(va,si.node,B,null,un))},w=function(S){c?(c.left=S,c=S):(u=S,c=S)};for(let S=0;S<l.count;++S){let B=l.nextBitIsOne(),te=Math.pow(2,l.count-(S+1));B?f(te,be.BLACK):(f(te,be.BLACK),f(te,be.RED))}return u},o=new Ri(n.length),a=s(o);return new ye(i||e,a)};var hi,Ct={},kt=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return g(Ct&&q,"ChildrenNode.ts has not been loaded"),hi=hi||new n({".priority":Ct},{".priority":q}),hi}get(e){let t=Qe(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ye?t:null}hasIndex(e){return Te(this.indexSet_,e.toString())}addIndex(e,t){g(e!==wt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=t.getIterator(O.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Nn(i,e.getCompare()):a=Ct;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let u=Object.assign({},this.indexes_);return u[l]=a,new n(u,c)}addToIndexes(e,t){let i=Lt(this.indexes_,(r,s)=>{let o=Qe(this.indexSet_,s);if(g(o,"Missing index implementation for "+s),r===Ct)if(o.isDefinedOn(e.node)){let a=[],l=t.getIterator(O.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Nn(a,o.getCompare())}else return Ct;else{let a=t.get(e.name),l=r;return a&&(l=l.remove(new O(e.name,a))),l.insert(e,e.node)}});return new n(i,this.indexSet_)}removeFromIndexes(e,t){let i=Lt(this.indexes_,r=>{if(r===Ct)return r;{let s=t.get(e.name);return s?r.remove(new O(e.name,s)):r}});return new n(i,this.indexSet_)}};var Ht,E=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Co(this.priorityNode_),this.children_.isEmpty()&&g(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ht||(Ht=new n(new ye(_r),null,kt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ht}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let i=this.children_.get(t);return i===null?Ht:i}}getChild(t){let i=R(t);return i===null?this:this.getImmediateChild(i).getChild(U(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,i){if(g(i,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(i);{let r=new O(t,i),s,o;i.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?Ht:this.priorityNode_;return new n(s,a,o)}}updateChild(t,i){let r=R(t);if(r===null)return i;{g(R(t)!==".priority"||ze(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(U(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(q,(a,l)=>{i[a]=l.val(t),r++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*r){let a=[];for(let l in i)a[l]=i[l];return a}else return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+go(this.getPriority().val())+":"),this.forEachChild(q,(i,r)=>{let s=r.hash();s!==""&&(t+=":"+i+":"+s)}),this.lazyHash_=t===""?"":qs(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new O(t,i));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){let i=this.getFirstChildName(t);return i?new O(i,this.children_.get(i)):null}getLastChildName(t){let i=this.resolveIndex_(t);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){let i=this.getLastChildName(t);return i?new O(i,this.children_.get(i)):null}forEachChild(t,i){let r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,O.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,O.Wrap),o=s.peek();for(;o!=null&&i.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===rn?-1:0}withIndex(t){if(t===wt||this.indexMap_.hasIndex(t))return this;{let i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===wt||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let i=t;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(q),s=i.getIterator(q),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===wt?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),Fi=class extends E{constructor(){super(new ye(_r),E.EMPTY_NODE,kt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return E.EMPTY_NODE}isEmpty(){return!1}},rn=new Fi;Object.defineProperties(O,{MIN:{value:new O(xt,E.EMPTY_NODE)},MAX:{value:new O(rt,rn)}});On.__EMPTY_NODE=E.EMPTY_NODE;St.__childrenNodeConstructor=E;fl(rn);ml(rn);var gl=!0;function J(n,e=null){if(n===null)return E.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),g(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new St(t,J(e))}if(!(n instanceof Array)&&gl){let t=[],i=!1;if(ue(n,(o,a)=>{if(o.substring(0,1)!=="."){let l=J(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new O(o,l)))}}),t.length===0)return E.EMPTY_NODE;let s=Nn(t,hl,o=>o.name,_r);if(i){let o=Nn(t,q.getCompare());return new E(s,J(e),new kt({".priority":o},{".priority":q}))}else return new E(s,J(e),kt.Default)}else{let t=E.EMPTY_NODE;return ue(n,(i,r)=>{if(Te(n,i)&&i.substring(0,1)!=="."){let s=J(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(J(e))}}pl(J);var Ai=class extends bt{constructor(e){super(),this.indexPath_=e,g(!N(e)&&R(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return s===0?Pt(e.name,t.name):s}makePost(e,t){let i=J(e),r=E.EMPTY_NODE.updateChild(this.indexPath_,i);return new O(t,r)}maxPost(){let e=E.EMPTY_NODE.updateChild(this.indexPath_,rn);return new O(rt,e)}toString(){return fo(this.indexPath_,0).join("/")}};var Di=class extends bt{compare(e,t){let i=e.node.compareTo(t.node);return i===0?Pt(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return O.MIN}maxPost(){return O.MAX}makePost(e,t){let i=J(e);return new O(t,i)}toString(){return".value"}},Cl=new Di;function wo(n){return{type:"value",snapshotNode:n}}function Mt(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function $t(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Qt(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function vl(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Zt=class{constructor(e){this.index_=e}updateChild(e,t,i,r,s,o){g(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange($t(t,a)):g(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Mt(t,i)):o.trackChildChange(Qt(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(q,(r,s)=>{t.hasChild(r)||i.trackChildChange($t(r,s))}),t.isLeafNode()||t.forEachChild(q,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Qt(r,s,o))}else i.trackChildChange(Mt(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?E.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Rn=class n{constructor(e){this.indexedFilter_=new Zt(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,s,o){return this.matches(new O(t,i))||(i=E.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,s,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=E.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(E.EMPTY_NODE);let s=this;return t.forEachChild(q,(o,a)=>{s.matches(new O(o,a))||(r=r.updateImmediateChild(o,E.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var Li=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{let i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Rn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,s,o){return this.rangedFilter_.matches(new O(t,i))||(i=E.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,s,o):this.fullLimitUpdateChild_(e,t,i,s,o)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=E.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=E.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(E.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,E.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(f,w)=>h(w,f)}else o=this.index_.getCompare();let a=e;g(a.numChildren()===this.limit_,"");let l=new O(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){let h=a.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===t||a.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);let w=f==null?1:o(f,l);if(u&&!i.isEmpty()&&w>=0)return s?.trackChildChange(Qt(t,i,h)),a.updateImmediateChild(t,i);{s?.trackChildChange($t(t,h));let B=a.updateImmediateChild(t,E.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(s?.trackChildChange(Mt(f.name,f.node)),B.updateImmediateChild(f.name,f.node)):B}}else return i.isEmpty()?e:u&&o(c,l)>=0?(s!=null&&(s.trackChildChange($t(c.name,c.node)),s.trackChildChange(Mt(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,E.EMPTY_NODE)):e}};var Vi=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=q}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return g(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return g(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:xt}hasEnd(){return this.endSet_}getIndexEndValue(){return g(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return g(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:rt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return g(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===q}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function yl(n){return n.loadsAllData()?new Zt(n.getIndex()):n.hasLimit()?new Li(n):new Rn(n)}function Ps(n){let e={};if(n.isDefault())return e;let t;if(n.index_===q?t="$priority":n.index_===Cl?t="$value":n.index_===wt?t="$key":(g(n.index_ instanceof Ai,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=K(t),n.startSet_){let i=n.startAfterSet_?"startAfter":"startAt";e[i]=K(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+K(n.indexStartName_))}if(n.endSet_){let i=n.endBeforeSet_?"endBefore":"endAt";e[i]=K(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+K(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Is(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==q&&(e.i=n.index_.toString()),e}var ji=class n extends En{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=nn("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(g(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,i),a={};this.listens_[o]=a;let l=Ps(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(s,h,!1,i),Qe(this.listens_,o)===a){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",r(f,null)}})}unlisten(e,t){let i=n.getListenId_(e,t);delete this.listens_[i]}get(e){let t=Ps(e._queryParams),i=e._path.toString(),r=new Cn;return this.restRequest_(i+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+es(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=vn(a.responseText)}catch{de("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&de("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var Gi=class{constructor(){this.rootNode_=E.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function Fn(){return{value:null,children:new Map}}function xo(n,e,t){if(N(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let i=R(e);n.children.has(i)||n.children.set(i,Fn());let r=n.children.get(i);e=U(e),xo(r,e,t)}}function Bi(n,e,t){n.value!==null?t(e,n.value):wl(n,(i,r)=>{let s=new G(e.toString()+"/"+i);Bi(r,s,t)})}function wl(n,e){n.children.forEach((t,i)=>{e(i,t)})}var Hi=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&ue(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}};var Os=10*1e3,xl=30*1e3,bl=5*60*1e3,Ui=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Hi(e);let i=Os+(xl-Os)*Math.random();Wt(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),t={},i=!1;ue(e,(r,s)=>{s>0&&Te(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),Wt(this.reportStats_.bind(this),Math.floor(Math.random()*2*bl))}};var Ee=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Ee||{});function bo(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function gr(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Cr(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var Wi=class n{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Ee.ACK_USER_WRITE,this.source=bo()}operationForChild(e){if(N(this.path)){if(this.affectedTree.value!=null)return g(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new G(e));return new n(L(),t,this.revert)}}else return g(R(this.path)===e,"operationForChild called for unrelated child."),new n(U(this.path),this.affectedTree,this.revert)}};var An=class n{constructor(e,t){this.source=e,this.path=t,this.type=Ee.LISTEN_COMPLETE}operationForChild(e){return N(this.path)?new n(this.source,L()):new n(this.source,U(this.path))}};var Tt=class n{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Ee.OVERWRITE}operationForChild(e){return N(this.path)?new n(this.source,L(),this.snap.getImmediateChild(e)):new n(this.source,U(this.path),this.snap)}};var Dn=class n{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Ee.MERGE}operationForChild(e){if(N(this.path)){let t=this.children.subtree(new G(e));return t.isEmpty()?null:t.value?new Tt(this.source,L(),t.value):new n(this.source,L(),t)}else return g(R(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,U(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Pe=class{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(N(e))return this.isFullyInitialized()&&!this.filtered_;let t=R(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var zi=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function Sl(n,e,t,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(vl(o.childName,o.snapshotNode))}),Ut(n,r,"child_removed",e,i,t),Ut(n,r,"child_added",e,i,t),Ut(n,r,"child_moved",s,i,t),Ut(n,r,"child_changed",e,i,t),Ut(n,r,"value",e,i,t),r}function Ut(n,e,t,i,r,s){let o=i.filter(a=>a.type===t);o.sort((a,l)=>Ml(n,a,l)),o.forEach(a=>{let l=kl(n,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function kl(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Ml(n,e,t){if(e.childName==null||t.childName==null)throw ht("Should only compare child_ events.");let i=new O(e.childName,e.snapshotNode),r=new O(t.childName,t.snapshotNode);return n.index_.compare(i,r)}function qn(n,e){return{eventCache:n,serverCache:e}}function qt(n,e,t,i){return qn(new Pe(e,t,i),n.serverCache)}function So(n,e,t,i){return qn(n.eventCache,new Pe(e,t,i))}function Ln(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function st(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var fi,Tl=()=>(fi||(fi=new ye(Ea)),fi),he=class n{constructor(e,t=Tl()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return ue(e,(i,r)=>{t=t.set(new G(i),r)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:L(),value:this.value};if(N(e))return null;{let i=R(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(U(e),t);return s!=null?{path:$(new G(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(N(e))return this;{let t=R(e),i=this.children.get(t);return i!==null?i.subtree(U(e)):new n(null)}}set(e,t){if(N(e))return new n(t,this.children);{let i=R(e),s=(this.children.get(i)||new n(null)).set(U(e),t),o=this.children.insert(i,s);return new n(this.value,o)}}remove(e){if(N(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=R(e),i=this.children.get(t);if(i){let r=i.remove(U(e)),s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(N(e))return this.value;{let t=R(e),i=this.children.get(t);return i?i.get(U(e)):null}}setTree(e,t){if(N(e))return t;{let i=R(e),s=(this.children.get(i)||new n(null)).setTree(U(e),t),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new n(this.value,o)}}fold(e){return this.fold_(L(),e)}fold_(e,t){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_($(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,L(),t)}findOnPath_(e,t,i){let r=this.value?i(t,this.value):!1;if(r)return r;if(N(e))return null;{let s=R(e),o=this.children.get(s);return o?o.findOnPath_(U(e),$(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,L(),t)}foreachOnPath_(e,t,i){if(N(e))return this;{this.value&&i(t,this.value);let r=R(e),s=this.children.get(r);return s?s.foreachOnPath_(U(e),$(t,r),i):new n(null)}}foreach(e){this.foreach_(L(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_($(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}};var ke=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new he(null))}};function Yt(n,e,t){if(N(e))return new ke(new he(t));{let i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=ae(r,e);return s=s.updateChild(o,t),new ke(n.writeTree_.set(r,s))}else{let r=new he(t),s=n.writeTree_.setTree(e,r);return new ke(s)}}}function Ns(n,e,t){let i=n;return ue(t,(r,s)=>{i=Yt(i,$(e,r),s)}),i}function Rs(n,e){if(N(e))return ke.empty();{let t=n.writeTree_.setTree(e,new he(null));return new ke(t)}}function qi(n,e){return ot(n,e)!=null}function ot(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ae(t.path,e)):null}function Fs(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(q,(i,r)=>{e.push(new O(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new O(i,r.value))}),e}function Ue(n,e){if(N(e))return n;{let t=ot(n,e);return t!=null?new ke(new he(t)):new ke(n.writeTree_.subtree(e))}}function Yi(n){return n.writeTree_.isEmpty()}function Et(n,e){return ko(L(),n.writeTree_,e)}function ko(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(g(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):t=ko($(n,r),s,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild($(n,".priority"),i)),t}}function Yn(n,e){return Po(e,n)}function El(n,e,t,i,r){g(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=Yt(n.visibleWrites,e,t)),n.lastWriteId=i}function Pl(n,e){for(let t=0;t<n.allWrites.length;t++){let i=n.allWrites[t];if(i.writeId===e)return i}return null}function Il(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);g(t>=0,"removeWrite called with nonexistent writeId.");let i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&Ol(a,i.path)?r=!1:Se(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return Nl(n),!0;if(i.snap)n.visibleWrites=Rs(n.visibleWrites,i.path);else{let a=i.children;ue(a,l=>{n.visibleWrites=Rs(n.visibleWrites,$(i.path,l))})}return!0}else return!1}function Ol(n,e){if(n.snap)return Se(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Se($(n.path,t),e))return!0;return!1}function Nl(n){n.visibleWrites=Mo(n.allWrites,Rl,L()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Rl(n){return n.visible}function Mo(n,e,t){let i=ke.empty();for(let r=0;r<n.length;++r){let s=n[r];if(e(s)){let o=s.path,a;if(s.snap)Se(t,o)?(a=ae(t,o),i=Yt(i,a,s.snap)):Se(o,t)&&(a=ae(o,t),i=Yt(i,L(),s.snap.getChild(a)));else if(s.children){if(Se(t,o))a=ae(t,o),i=Ns(i,a,s.children);else if(Se(o,t))if(a=ae(o,t),N(a))i=Ns(i,L(),s.children);else{let l=Qe(s.children,R(a));if(l){let c=l.getChild(U(a));i=Yt(i,L(),c)}}}else throw ht("WriteRecord should have .snap or .children")}}return i}function To(n,e,t,i,r){if(!i&&!r){let s=ot(n.visibleWrites,e);if(s!=null)return s;{let o=Ue(n.visibleWrites,e);if(Yi(o))return t;if(t==null&&!qi(o,L()))return null;{let a=t||E.EMPTY_NODE;return Et(o,a)}}}else{let s=Ue(n.visibleWrites,e);if(!r&&Yi(s))return t;if(!r&&t==null&&!qi(s,L()))return null;{let o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(Se(c.path,e)||Se(e,c.path))},a=Mo(n.allWrites,o,e),l=t||E.EMPTY_NODE;return Et(a,l)}}}function Fl(n,e,t){let i=E.EMPTY_NODE,r=ot(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(q,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){let s=Ue(n.visibleWrites,e);return t.forEachChild(q,(o,a)=>{let l=Et(Ue(s,new G(o)),a);i=i.updateImmediateChild(o,l)}),Fs(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=Ue(n.visibleWrites,e);return Fs(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function Al(n,e,t,i,r){g(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=$(e,t);if(qi(n.visibleWrites,s))return null;{let o=Ue(n.visibleWrites,s);return Yi(o)?r.getChild(t):Et(o,r.getChild(t))}}function Dl(n,e,t,i){let r=$(e,t),s=ot(n.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(t)){let o=Ue(n.visibleWrites,r);return Et(o,i.getNode().getImmediateChild(t))}else return null}function Ll(n,e){return ot(n.visibleWrites,e)}function Vl(n,e,t,i,r,s,o){let a,l=Ue(n.visibleWrites,e),c=ot(l,L());if(c!=null)a=c;else if(t!=null)a=Et(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],h=o.getCompare(),f=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),w=f.getNext();for(;w&&u.length<r;)h(w,i)!==0&&u.push(w),w=f.getNext();return u}else return[]}function jl(){return{visibleWrites:ke.empty(),allWrites:[],lastWriteId:-1}}function Vn(n,e,t,i){return To(n.writeTree,n.treePath,e,t,i)}function vr(n,e){return Fl(n.writeTree,n.treePath,e)}function As(n,e,t,i){return Al(n.writeTree,n.treePath,e,t,i)}function jn(n,e){return Ll(n.writeTree,$(n.treePath,e))}function Gl(n,e,t,i,r,s){return Vl(n.writeTree,n.treePath,e,t,i,r,s)}function yr(n,e,t){return Dl(n.writeTree,n.treePath,e,t)}function Eo(n,e){return Po($(n.treePath,e),n.writeTree)}function Po(n,e){return{treePath:n,writeTree:e}}var Ki=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,i=e.childName;g(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),g(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(i,Qt(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(i,$t(i,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(i,Mt(i,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(i,Qt(i,e.snapshotNode,r.oldSnap));else throw ht("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var $i=class{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}},Io=new $i,Xt=class{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new Pe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yr(this.writes_,e,i)}}getChildAfterChild(e,t,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:st(this.viewCache_),s=Gl(this.writes_,r,t,1,i,e);return s.length===0?null:s[0]}};function Bl(n){return{filter:n}}function Hl(n,e){g(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),g(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Ul(n,e,t,i,r){let s=new Ki,o,a;if(t.type===Ee.OVERWRITE){let c=t;c.source.fromUser?o=Qi(n,e,c.path,c.snap,i,r,s):(g(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!N(c.path),o=Gn(n,e,c.path,c.snap,i,r,a,s))}else if(t.type===Ee.MERGE){let c=t;c.source.fromUser?o=zl(n,e,c.path,c.children,i,r,s):(g(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=Zi(n,e,c.path,c.children,i,r,a,s))}else if(t.type===Ee.ACK_USER_WRITE){let c=t;c.revert?o=Kl(n,e,c.path,i,r,s):o=ql(n,e,c.path,c.affectedTree,i,r,s)}else if(t.type===Ee.LISTEN_COMPLETE)o=Yl(n,e,t.path,i,s);else throw ht("Unknown operation type: "+t.type);let l=s.getChanges();return Wl(e,o,l),{viewCache:o,changes:l}}function Wl(n,e,t){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Ln(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(wo(Ln(e)))}}function Oo(n,e,t,i,r,s){let o=e.eventCache;if(jn(i,t)!=null)return e;{let a,l;if(N(t))if(g(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=st(e),u=c instanceof E?c:E.EMPTY_NODE,h=vr(i,u);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let c=Vn(i,st(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=R(t);if(c===".priority"){g(ze(t)===1,"Can't have a priority with additional path components");let u=o.getNode();l=e.serverCache.getNode();let h=As(i,t,u,l);h!=null?a=n.filter.updatePriority(u,h):a=o.getNode()}else{let u=U(t),h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let f=As(i,t,o.getNode(),l);f!=null?h=o.getNode().getImmediateChild(c).updateChild(u,f):h=o.getNode().getImmediateChild(c)}else h=yr(i,c,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),c,h,u,r,s):a=o.getNode()}}return qt(e,a,o.isFullyInitialized()||N(t),n.filter.filtersNodes())}}function Gn(n,e,t,i,r,s,o,a){let l=e.serverCache,c,u=o?n.filter:n.filter.getIndexedFilter();if(N(t))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){let w=l.getNode().updateChild(t,i);c=u.updateFullNode(l.getNode(),w,null)}else{let w=R(t);if(!l.isCompleteForPath(t)&&ze(t)>1)return e;let S=U(t),te=l.getNode().getImmediateChild(w).updateChild(S,i);w===".priority"?c=u.updatePriority(l.getNode(),te):c=u.updateChild(l.getNode(),w,te,S,Io,null)}let h=So(e,c,l.isFullyInitialized()||N(t),u.filtersNodes()),f=new Xt(r,h,s);return Oo(n,h,t,r,f,a)}function Qi(n,e,t,i,r,s,o){let a=e.eventCache,l,c,u=new Xt(r,e,s);if(N(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=qt(e,c,!0,n.filter.filtersNodes());else{let h=R(t);if(h===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),l=qt(e,c,a.isFullyInitialized(),a.isFiltered());else{let f=U(t),w=a.getNode().getImmediateChild(h),S;if(N(f))S=i;else{let B=u.getCompleteChild(h);B!=null?ho(f)===".priority"&&B.getChild(po(f)).isEmpty()?S=B:S=B.updateChild(f,i):S=E.EMPTY_NODE}if(w.equals(S))l=e;else{let B=n.filter.updateChild(a.getNode(),h,S,f,u,o);l=qt(e,B,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function Ds(n,e){return n.eventCache.isCompleteForChild(e)}function zl(n,e,t,i,r,s,o){let a=e;return i.foreach((l,c)=>{let u=$(t,l);Ds(e,R(u))&&(a=Qi(n,a,u,c,r,s,o))}),i.foreach((l,c)=>{let u=$(t,l);Ds(e,R(u))||(a=Qi(n,a,u,c,r,s,o))}),a}function Ls(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function Zi(n,e,t,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;N(t)?c=i:c=new he(null).setTree(t,i);let u=e.serverCache.getNode();return c.children.inorderTraversal((h,f)=>{if(u.hasChild(h)){let w=e.serverCache.getNode().getImmediateChild(h),S=Ls(n,w,f);l=Gn(n,l,new G(h),S,r,s,o,a)}}),c.children.inorderTraversal((h,f)=>{let w=!e.serverCache.isCompleteForChild(h)&&f.value===null;if(!u.hasChild(h)&&!w){let S=e.serverCache.getNode().getImmediateChild(h),B=Ls(n,S,f);l=Gn(n,l,new G(h),B,r,s,o,a)}}),l}function ql(n,e,t,i,r,s,o){if(jn(r,t)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(N(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Gn(n,e,t,l.getNode().getChild(t),r,s,a,o);if(N(t)){let c=new he(null);return l.getNode().forEachChild(wt,(u,h)=>{c=c.set(new G(u),h)}),Zi(n,e,t,c,r,s,a,o)}else return e}else{let c=new he(null);return i.foreach((u,h)=>{let f=$(t,u);l.isCompleteForPath(f)&&(c=c.set(u,l.getNode().getChild(f)))}),Zi(n,e,t,c,r,s,a,o)}}function Yl(n,e,t,i,r){let s=e.serverCache,o=So(e,s.getNode(),s.isFullyInitialized()||N(t),s.isFiltered());return Oo(n,o,t,i,Io,r)}function Kl(n,e,t,i,r,s){let o;if(jn(i,t)!=null)return e;{let a=new Xt(i,e,r),l=e.eventCache.getNode(),c;if(N(t)||R(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Vn(i,st(e));else{let h=e.serverCache.getNode();g(h instanceof E,"serverChildren would be complete if leaf node"),u=vr(i,h)}u=u,c=n.filter.updateFullNode(l,u,s)}else{let u=R(t),h=yr(i,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=n.filter.updateChild(l,u,h,U(t),a,s):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(l,u,E.EMPTY_NODE,U(t),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Vn(i,st(e)),o.isLeafNode()&&(c=n.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||jn(i,L())!=null,qt(e,c,o,n.filter.filtersNodes())}}var Xi=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new Zt(i.getIndex()),s=yl(i);this.processor_=Bl(s);let o=t.serverCache,a=t.eventCache,l=r.updateFullNode(E.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(E.EMPTY_NODE,a.getNode(),null),u=new Pe(l,o.isFullyInitialized(),r.filtersNodes()),h=new Pe(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=qn(h,u),this.eventGenerator_=new zi(this.query_)}get query(){return this.query_}};function $l(n){return n.viewCache_.serverCache.getNode()}function Ql(n){return Ln(n.viewCache_)}function Zl(n,e){let t=st(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!N(e)&&!t.getImmediateChild(R(e)).isEmpty())?t.getChild(e):null}function Vs(n){return n.eventRegistrations_.length===0}function Xl(n,e){n.eventRegistrations_.push(e)}function js(n,e,t){let i=[];if(t){g(e==null,"A cancel should cancel all event registrations.");let r=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function Gs(n,e,t,i){e.type===Ee.MERGE&&e.source.queryId!==null&&(g(st(n.viewCache_),"We should always have a full cache before handling merges"),g(Ln(n.viewCache_),"Missing event cache, even though we have a server cache"));let r=n.viewCache_,s=Ul(n.processor_,r,e,t,i);return Hl(n.processor_,s.viewCache),g(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,No(n,s.changes,s.viewCache.eventCache.getNode(),null)}function Jl(n,e){let t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(q,(s,o)=>{i.push(Mt(s,o))}),t.isFullyInitialized()&&i.push(wo(t.getNode())),No(n,i,t.getNode(),e)}function No(n,e,t,i){let r=i?[i]:n.eventRegistrations_;return Sl(n.eventGenerator_,e,t,r)}var Bn,Hn=class{constructor(){this.views=new Map}};function ec(n){g(!Bn,"__referenceConstructor has already been defined"),Bn=n}function tc(){return g(Bn,"Reference.ts has not been loaded"),Bn}function nc(n){return n.views.size===0}function wr(n,e,t,i){let r=e.source.queryId;if(r!==null){let s=n.views.get(r);return g(s!=null,"SyncTree gave us an op for an invalid query."),Gs(s,e,t,i)}else{let s=[];for(let o of n.views.values())s=s.concat(Gs(o,e,t,i));return s}}function Ro(n,e,t,i,r){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=Vn(t,r?i:null),l=!1;a?l=!0:i instanceof E?(a=vr(t,i),l=!1):(a=E.EMPTY_NODE,l=!1);let c=qn(new Pe(a,l,!1),new Pe(i,r,!1));return new Xi(e,c)}return o}function ic(n,e,t,i,r,s){let o=Ro(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),Xl(o,t),Jl(o,t)}function rc(n,e,t,i){let r=e._queryIdentifier,s=[],o=[],a=qe(n);if(r==="default")for(let[l,c]of n.views.entries())o=o.concat(js(c,t,i)),Vs(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=n.views.get(r);l&&(o=o.concat(js(l,t,i)),Vs(l)&&(n.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!qe(n)&&s.push(new(tc())(e._repo,e._path)),{removed:s,events:o}}function Fo(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function We(n,e){let t=null;for(let i of n.views.values())t=t||Zl(i,e);return t}function Ao(n,e){if(e._queryParams.loadsAllData())return Kn(n);{let i=e._queryIdentifier;return n.views.get(i)}}function Do(n,e){return Ao(n,e)!=null}function qe(n){return Kn(n)!=null}function Kn(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Un;function sc(n){g(!Un,"__referenceConstructor has already been defined"),Un=n}function oc(){return g(Un,"Reference.ts has not been loaded"),Un}var ac=1,Wn=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new he(null),this.pendingWriteTree_=jl(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Lo(n,e,t,i,r){return El(n.pendingWriteTree_,e,t,i,r),r?on(n,new Tt(bo(),e,t)):[]}function nt(n,e,t=!1){let i=Pl(n.pendingWriteTree_,e);if(Il(n.pendingWriteTree_,e)){let s=new he(null);return i.snap!=null?s=s.set(L(),!0):ue(i.children,o=>{s=s.set(new G(o),!0)}),on(n,new Wi(i.path,s,t))}else return[]}function sn(n,e,t){return on(n,new Tt(gr(),e,t))}function lc(n,e,t){let i=he.fromObject(t);return on(n,new Dn(gr(),e,i))}function cc(n,e){return on(n,new An(gr(),e))}function dc(n,e,t){let i=br(n,t);if(i){let r=Sr(i),s=r.path,o=r.queryId,a=ae(s,e),l=new An(Cr(o),a);return kr(n,s,l)}else return[]}function Vo(n,e,t,i,r=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||Do(o,e))){let l=rc(o,e,t,i);nc(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let c=l.removed;if(a=l.events,!r){let u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(f,w)=>qe(w));if(u&&!h){let f=n.syncPointTree_.subtree(s);if(!f.isEmpty()){let w=pc(f);for(let S=0;S<w.length;++S){let B=w[S],te=B.query,lt=Ho(n,B);n.listenProvider_.startListening(Kt(te),Jt(n,te),lt.hashFn,lt.onComplete)}}}!h&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(Kt(e),null):c.forEach(f=>{let w=n.queryToTagMap.get($n(f));n.listenProvider_.stopListening(Kt(f),w)}))}mc(n,c)}return a}function jo(n,e,t,i){let r=br(n,i);if(r!=null){let s=Sr(r),o=s.path,a=s.queryId,l=ae(o,e),c=new Tt(Cr(a),l,t);return kr(n,o,c)}else return[]}function uc(n,e,t,i){let r=br(n,i);if(r){let s=Sr(r),o=s.path,a=s.queryId,l=ae(o,e),c=he.fromObject(t),u=new Dn(Cr(a),l,c);return kr(n,o,u)}else return[]}function hc(n,e,t,i=!1){let r=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(r,(f,w)=>{let S=ae(f,r);s=s||We(w,S),o=o||qe(w)});let a=n.syncPointTree_.get(r);a?(o=o||qe(a),s=s||We(a,L())):(a=new Hn,n.syncPointTree_=n.syncPointTree_.set(r,a));let l;s!=null?l=!0:(l=!1,s=E.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((w,S)=>{let B=We(S,L());B&&(s=s.updateImmediateChild(w,B))}));let c=Do(a,e);if(!c&&!e._queryParams.loadsAllData()){let f=$n(e);g(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");let w=_c();n.queryToTagMap.set(f,w),n.tagToQueryMap.set(w,f)}let u=Yn(n.pendingWriteTree_,r),h=ic(a,e,t,u,s,l);if(!c&&!o&&!i){let f=Ao(a,e);h=h.concat(gc(n,e,f))}return h}function xr(n,e,t){let r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let l=ae(o,e),c=We(a,l);if(c)return c});return To(r,e,s,t,!0)}function fc(n,e){let t=e._path,i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{let h=ae(c,t);i=i||We(u,h)});let r=n.syncPointTree_.get(t);r?i=i||We(r,L()):(r=new Hn,n.syncPointTree_=n.syncPointTree_.set(t,r));let s=i!=null,o=s?new Pe(i,!0,!1):null,a=Yn(n.pendingWriteTree_,e._path),l=Ro(r,e,a,s?o.getNode():E.EMPTY_NODE,s);return Ql(l)}function on(n,e){return Go(e,n.syncPointTree_,null,Yn(n.pendingWriteTree_,L()))}function Go(n,e,t,i){if(N(n.path))return Bo(n,e,t,i);{let r=e.get(L());t==null&&r!=null&&(t=We(r,L()));let s=[],o=R(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){let c=t?t.getImmediateChild(o):null,u=Eo(i,o);s=s.concat(Go(a,l,c,u))}return r&&(s=s.concat(wr(r,n,i,t))),s}}function Bo(n,e,t,i){let r=e.get(L());t==null&&r!=null&&(t=We(r,L()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=t?t.getImmediateChild(o):null,c=Eo(i,o),u=n.operationForChild(o);u&&(s=s.concat(Bo(u,a,l,c)))}),r&&(s=s.concat(wr(r,n,i,t))),s}function Ho(n,e){let t=e.query,i=Jt(n,t);return{hashFn:()=>($l(e)||E.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?dc(n,t._path,i):cc(n,t._path);{let s=Oa(r,t);return Vo(n,t,null,s)}}}}function Jt(n,e){let t=$n(e);return n.queryToTagMap.get(t)}function $n(n){return n._path.toString()+"$"+n._queryIdentifier}function br(n,e){return n.tagToQueryMap.get(e)}function Sr(n){let e=n.indexOf("$");return g(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new G(n.substr(0,e))}}function kr(n,e,t){let i=n.syncPointTree_.get(e);g(i,"Missing sync point for query tag that we're tracking");let r=Yn(n.pendingWriteTree_,e);return wr(i,t,r,null)}function pc(n){return n.fold((e,t,i)=>{if(t&&qe(t))return[Kn(t)];{let r=[];return t&&(r=Fo(t)),ue(i,(s,o)=>{r=r.concat(o)}),r}})}function Kt(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(oc())(n._repo,n._path):n}function mc(n,e){for(let t=0;t<e.length;++t){let i=e[t];if(!i._queryParams.loadsAllData()){let r=$n(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}function _c(){return ac++}function gc(n,e,t){let i=e._path,r=Jt(n,e),s=Ho(n,t),o=n.listenProvider_.startListening(Kt(e),r,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(i);if(r)g(!qe(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,u,h)=>{if(!N(c)&&u&&qe(u))return[Kn(u).query];{let f=[];return u&&(f=f.concat(Fo(u).map(w=>w.query))),ue(h,(w,S)=>{f=f.concat(S)}),f}});for(let c=0;c<l.length;++c){let u=l[c];n.listenProvider_.stopListening(Kt(u),Jt(n,u))}}return o}var Ji=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},er=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=$(this.path_,e);return new n(this.syncTree_,t)}node(){return xr(this.syncTree_,this.path_)}},Cc=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Bs=function(n,e,t){if(!n||typeof n!="object")return n;if(g(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return vc(n[".sv"],e,t);if(typeof n[".sv"]=="object")return yc(n[".sv"],e);g(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},vc=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:g(!1,"Unexpected server value: "+n)}},yc=function(n,e,t){n.hasOwnProperty("increment")||g(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let i=n.increment;typeof i!="number"&&g(!1,"Unexpected increment value: "+i);let r=e.node();if(g(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},wc=function(n,e,t,i){return Mr(e,new er(t,n),i)},Uo=function(n,e,t){return Mr(n,new Ji(e),t)};function Mr(n,e,t){let i=n.getPriority().val(),r=Bs(i,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=Bs(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new St(a,J(r)):n}else{let o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new St(r))),o.forEachChild(q,(a,l)=>{let c=Mr(l,e.getImmediateChild(a),t);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var en=class{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}};function Tr(n,e){let t=e instanceof G?e:new G(e),i=n,r=R(t);for(;r!==null;){let s=Qe(i.node.children,r)||{children:{},childCount:0};i=new en(r,i,s),t=U(t),r=R(t)}return i}function Ot(n){return n.node.value}function Wo(n,e){n.node.value=e,tr(n)}function zo(n){return n.node.childCount>0}function xc(n){return Ot(n)===void 0&&!zo(n)}function Qn(n,e){ue(n.node.children,(t,i)=>{e(new en(t,n,i))})}function qo(n,e,t,i){t&&!i&&e(n),Qn(n,r=>{qo(r,e,!0,i)}),t&&i&&e(n)}function bc(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function an(n){return new G(n.parent===null?n.name:an(n.parent)+"/"+n.name)}function tr(n){n.parent!==null&&Sc(n.parent,n.name,n)}function Sc(n,e,t){let i=xc(t),r=Te(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,tr(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,tr(n))}var kc=/[\[\].#$\/\u0000-\u001F\u007F]/,Mc=/[\[\].#$\u0000-\u001F\u007F]/,pi=10*1024*1024,Yo=function(n){return typeof n=="string"&&n.length!==0&&!kc.test(n)},Ko=function(n){return typeof n=="string"&&n.length!==0&&!Mc.test(n)},Tc=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ko(n)};var Ec=function(n,e,t,i){i&&e===void 0||Er(yn(n,"value"),e,t)},Er=function(n,e,t){let i=t instanceof G?new Ei(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+et(i));if(typeof e=="function")throw new Error(n+"contains a function "+et(i)+" with contents = "+e.toString());if(Ys(e))throw new Error(n+"contains "+e.toString()+" "+et(i));if(typeof e=="string"&&e.length>pi/3&&Vt(e)>pi)throw new Error(n+"contains a string greater than "+pi+" utf8 bytes "+et(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(ue(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Yo(o)))throw new Error(n+" contains an invalid key ("+o+") "+et(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);ol(i,o),Er(n,a,i),al(i)}),r&&s)throw new Error(n+' contains ".value" child '+et(i)+" in addition to actual children.")}};var $o=function(n,e,t,i){if(!(i&&t===void 0)&&!Ko(t))throw new Error(yn(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Pc=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),$o(n,e,t,i)},Qo=function(n,e){if(R(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},Ic=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Yo(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Tc(t))throw new Error(yn(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var nr=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Zo(n,e){let t=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();t!==null&&!mo(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function Ie(n,e,t){Zo(n,t),Oc(n,i=>Se(i,e)||Se(e,i))}function Oc(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){let r=n.eventLists_[i];if(r){let s=r.path;e(s)?(Nc(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function Nc(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let i=t.getEventRunner();it&&se("event: "+t.toString()),It(i)}}}var Rc="repo_interrupt",Fc=25,ir=class{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new nr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Fn(),this.transactionQueueTree_=new en,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Ac(n,e,t){if(n.stats_=pr(n.repoInfo_),n.forceRestClient_||Aa())n.server_=new ji(n.repoInfo_,(i,r,s,o)=>{Hs(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Us(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{K(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new mr(n.repoInfo_,e,(i,r,s,o)=>{Hs(n,i,r,s,o)},i=>{Us(n,i)},i=>{Lc(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=La(n.repoInfo_,()=>new Ui(n.stats_,n.server_)),n.infoData_=new Gi,n.infoSyncTree_=new Wn({startListening:(i,r,s,o)=>{let a=[],l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=sn(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Ir(n,"connected",!1),n.serverSyncTree_=new Wn({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(a,l)=>{let c=o(a,l);Ie(n.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function Dc(n){let t=n.infoData_.getNode(new G(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Pr(n){return Cc({timestamp:Dc(n)})}function Hs(n,e,t,i,r){n.dataUpdateCount++;let s=new G(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){let l=Lt(t,c=>J(c));o=uc(n.serverSyncTree_,s,l,r)}else{let l=J(t);o=jo(n.serverSyncTree_,s,l,r)}else if(i){let l=Lt(t,c=>J(c));o=lc(n.serverSyncTree_,s,l)}else{let l=J(t);o=sn(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Xn(n,s)),Ie(n.eventQueue_,a,o)}function Us(n,e){Ir(n,"connected",e),e===!1&&Gc(n)}function Lc(n,e){ue(e,(t,i)=>{Ir(n,t,i)})}function Ir(n,e,t){let i=new G("/.info/"+e),r=J(t);n.infoData_.updateSnapshot(i,r);let s=sn(n.infoSyncTree_,i,r);Ie(n.eventQueue_,i,s)}function Xo(n){return n.nextWriteId_++}function Vc(n,e,t){let i=fc(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(r=>{let s=J(r).withIndex(e._queryParams.getIndex());hc(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=sn(n.serverSyncTree_,e._path,s);else{let a=Jt(n.serverSyncTree_,e);o=jo(n.serverSyncTree_,e._path,s,a)}return Ie(n.eventQueue_,e._path,o),Vo(n.serverSyncTree_,e,t,null,!0),s},r=>(Zn(n,"get for query "+K(e)+" failed: "+r),Promise.reject(new Error(r))))}function jc(n,e,t,i,r){Zn(n,"set",{path:e.toString(),value:t,priority:i});let s=Pr(n),o=J(t,i),a=xr(n.serverSyncTree_,e),l=Uo(o,a,s),c=Xo(n),u=Lo(n.serverSyncTree_,e,l,c,!0);Zo(n.eventQueue_,u),n.server_.put(e.toString(),o.val(!0),(f,w)=>{let S=f==="ok";S||de("set at "+e+" failed: "+f);let B=nt(n.serverSyncTree_,c,!S);Ie(n.eventQueue_,e,B),Hc(n,r,f,w)});let h=ia(n,e);Xn(n,h),Ie(n.eventQueue_,h,[])}function Gc(n){Zn(n,"onDisconnectEvents");let e=Pr(n),t=Fn();Bi(n.onDisconnect_,L(),(r,s)=>{let o=wc(r,s,n.serverSyncTree_,e);xo(t,r,o)});let i=[];Bi(t,L(),(r,s)=>{i=i.concat(sn(n.serverSyncTree_,r,s));let o=ia(n,r);Xn(n,o)}),n.onDisconnect_=Fn(),Ie(n.eventQueue_,L(),i)}function Bc(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Rc)}function Zn(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),se(t,...e)}function Hc(n,e,t,i){e&&It(()=>{if(t==="ok")e(null);else{let r=(t||"error").toUpperCase(),s=r;i&&(s+=": "+i);let o=new Error(s);o.code=r,e(o)}})}function Jo(n,e,t){return xr(n.serverSyncTree_,e,t)||E.EMPTY_NODE}function Or(n,e=n.transactionQueueTree_){if(e||Jn(n,e),Ot(e)){let t=ta(n,e);g(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&Uc(n,an(e),t)}else zo(e)&&Qn(e,t=>{Or(n,t)})}function Uc(n,e,t){let i=t.map(c=>c.currentWriteId),r=Jo(n,e,i),s=r,o=r.hash();for(let c=0;c<t.length;c++){let u=t[c];g(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let h=ae(e,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;n.server_.put(l.toString(),a,c=>{Zn(n,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){let h=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(nt(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&h.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();Jn(n,Tr(n.transactionQueueTree_,e)),Or(n,n.transactionQueueTree_),Ie(n.eventQueue_,e,u);for(let f=0;f<h.length;f++)It(h[f])}else{if(c==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{de("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=c}Xn(n,e)}},o)}function Xn(n,e){let t=ea(n,e),i=an(t),r=ta(n,t);return Wc(n,r,i),i}function Wc(n,e,t){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=ae(t,l.path),u=!1,h;if(g(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,r=r.concat(nt(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Fc)u=!0,h="maxretry",r=r.concat(nt(n.serverSyncTree_,l.currentWriteId,!0));else{let f=Jo(n,l.path,o);l.currentInputSnapshot=f;let w=e[a].update(f.val());if(w!==void 0){Er("transaction failed: Data returned ",w,l.path);let S=J(w);typeof w=="object"&&w!=null&&Te(w,".priority")||(S=S.updatePriority(f.getPriority()));let te=l.currentWriteId,lt=Pr(n),un=Uo(S,f,lt);l.currentOutputSnapshotRaw=S,l.currentOutputSnapshotResolved=un,l.currentWriteId=Xo(n),o.splice(o.indexOf(te),1),r=r.concat(Lo(n.serverSyncTree_,l.path,un,l.currentWriteId,l.applyLocally)),r=r.concat(nt(n.serverSyncTree_,te,!0))}else u=!0,h="nodata",r=r.concat(nt(n.serverSyncTree_,l.currentWriteId,!0))}Ie(n.eventQueue_,t,r),r=[],u&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(h),!1,null))))}Jn(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)It(i[a]);Or(n,n.transactionQueueTree_)}function ea(n,e){let t,i=n.transactionQueueTree_;for(t=R(e);t!==null&&Ot(i)===void 0;)i=Tr(i,t),e=U(e),t=R(e);return i}function ta(n,e){let t=[];return na(n,e,t),t.sort((i,r)=>i.order-r.order),t}function na(n,e,t){let i=Ot(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);Qn(e,r=>{na(n,r,t)})}function Jn(n,e){let t=Ot(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,Wo(e,t.length>0?t:void 0)}Qn(e,i=>{Jn(n,i)})}function ia(n,e){let t=an(ea(n,e)),i=Tr(n.transactionQueueTree_,e);return bc(i,r=>{mi(n,r)}),mi(n,i),qo(i,r=>{mi(n,r)}),t}function mi(n,e){let t=Ot(e);if(t){let i=[],r=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(g(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(g(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(nt(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Wo(e,void 0):t.length=s+1,Ie(n.eventQueue_,an(e),r);for(let o=0;o<i.length;o++)It(i[o])}}function zc(n){let e="",t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function qc(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):de(`Invalid query segment '${t}' in query '${n}'`)}return e}var Ws=function(n,e){let t=Yc(n),i=t.namespace;t.domain==="firebase.com"&&Ae(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Ae("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Ma();let r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Mn(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new G(t.pathString)}},Yc=function(n){let e="",t="",i="",r="",s="",o=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(u,h)),u<h&&(r=zc(n.substring(u,h)));let f=qc(n.substring(Math.min(n.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let w=e.slice(0,c);if(w.toLowerCase()==="localhost")t="localhost";else if(w.split(".").length<=2)t=w;else{let S=e.indexOf(".");i=e.substring(0,S).toLowerCase(),t=e.substring(S+1),s=i}"ns"in f&&(s=f.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var rr=class{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+K(this.snapshot.exportVal())}},sr=class{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var or=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return g(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var ar=class n{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return N(this._path)?null:ho(this._path)}get ref(){return new De(this._repo,this._path)}get _queryIdentifier(){let e=Is(this._queryParams),t=fr(e);return t==="{}"?"default":t}get _queryObject(){return Is(this._queryParams)}isEqual(e){if(e=Ze(e),!(e instanceof n))return!1;let t=this._repo===e._repo,i=mo(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+sl(this._path)}};var De=class n extends ar{constructor(e,t){super(e,t,new Vi,!1)}get parent(){let e=po(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},zn=class n{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new G(e),i=lr(this.ref,e);return new n(this._node.getChild(t),i,q)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new n(r,lr(this.ref,i),q)))}hasChild(e){let t=new G(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function we(n,e){return n=Ze(n),n._checkNotDeleted("ref"),e!==void 0?lr(n._root,e):n._root}function lr(n,e){return n=Ze(n),R(n._path)===null?Pc("child","path",e,!1):$o("child","path",e,!1),new De(n._repo,$(n._path,e))}function Nr(n){return Qo("remove",n._path),at(n,null)}function at(n,e){n=Ze(n),Qo("set",n._path),Ec("set",e,n._path,!1);let t=new Cn;return jc(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function ln(n){n=Ze(n);let e=new or(()=>{}),t=new cr(e);return Vc(n._repo,n,t).then(i=>new zn(i,new De(n._repo,n._path),n._queryParams.getIndex()))}var cr=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let i=t._queryParams.getIndex();return new rr("value",this,new zn(e.snapshotNode,new De(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new sr(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}};ec(De);sc(De);var Kc="FIREBASE_DATABASE_EMULATOR_HOST",dr={},$c=!1;function Qc(n,e,t,i){n.repoInfo_=new Mn(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function Zc(n,e,t,i,r){let s=i||n.options.databaseURL;s===void 0&&(n.options.projectId||Ae("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),se("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=Ws(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[Kc]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=Ws(s,r),a=o.repoInfo):l=!o.repoInfo.secure;let u=r&&l?new zt(zt.OWNER):new wi(n.name,n.options,e);Ic("Invalid Firebase Database URL",o),N(o.path)||Ae("Database URL must point to the root of a Firebase Database (not including a child path).");let h=Jc(a,n,u,new yi(n.name,t));return new ur(h,n)}function Xc(n,e){let t=dr[e];(!t||t[n.key]!==n)&&Ae(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Bc(n),delete t[n.key]}function Jc(n,e,t,i){let r=dr[e.name];r||(r={},dr[e.name]=r);let s=r[n.toURLString()];return s&&Ae("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ir(n,$c,t,i),r[n.toURLString()]=s,s}var ur=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Ac(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new De(this._repo,L())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Xc(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ae("Cannot call "+e+" on a deleted database.")}};function ra(n=cs(),e){let t=as(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let i=$r("database");i&&ed(t,...i)}return t}function ed(n,e,t,i={}){n=Ze(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Ae("Cannot call useEmulator() after instance has already been initialized.");let r=n._repoInternal,s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Ae('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new zt(zt.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:Qr(i.mockUserToken,n.app.options.projectId);s=new zt(o)}Qc(r,e,t,s)}function td(n){ba(ls),os(new is("database",(e,{instanceIdentifier:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Zc(i,r,s,t)},"PUBLIC").setMultipleInstances(!0)),li(fs,ps,n),li(fs,ps,"esm2017")}mr.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};mr.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};td();var Nt=(()=>{let e=class e{constructor(){}isLocal(){return location.hostname==="localhost"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Ye=(()=>{let e=class e{constructor(i,r,s){this.authService=i,this.envService=r,this.router=s}getCardsLocation(){return this.authService.user+"/cards"}getSetsLocation(){return this.authService.user+"/sets"}getDb(){let i=this.authService.getFirebaseApp();return i||this.router.navigateByUrl("/auth"),i?ra(i):null}getLocalLang(i){return i==="base_lang"?"en":"de"}getLanguage(i){return M(this,null,function*(){if(this.envService.isLocal())return this.getLocalLang(i);let r=this.getDb();if(!r)return null;let s=we(r,this.authService.user+"/"+i);return yield ln(s).then(o=>o.exists()?o.toJSON():null)})}getBaseLanguage(){return M(this,null,function*(){return this.getLanguage("base_lang")})}getGoalLanguage(){return M(this,null,function*(){return this.getLanguage("goal_lang")})}getSettings(){return M(this,null,function*(){let i=this.getDb();if(!i||this.envService.isLocal())return null;let r=we(i,this.authService.user+"/settings");return yield ln(r).then(s=>s.exists()?s.toJSON():null)})}setSettings(i){return M(this,null,function*(){let r=this.getDb();if(!r||this.envService.isLocal())return;let s=we(r,this.authService.user+"/settings");return yield at(s,i)})}getCards(){return M(this,null,function*(){let i=this.getDb();if(!i)return null;let r=we(i,this.getCardsLocation());return yield ln(r).then(s=>s.exists()?s.toJSON():null)})}updateCard(i){return M(this,null,function*(){let r=this.getDb();if(r)return at(we(r,this.getCardsLocation()+"/"+i.id),i)})}addCard(i){return M(this,null,function*(){let r=this.getDb();if(r)return at(we(r,this.getCardsLocation()+"/"+i.id),i)})}deleteCard(i){return M(this,null,function*(){let r=this.getDb();if(r)return Nr(we(r,this.getCardsLocation()+"/"+i))})}getSets(){return M(this,null,function*(){let i=this.getDb();if(!i)return null;let r=we(i,this.getSetsLocation());return yield ln(r).then(s=>s.exists()?s.toJSON():null)})}addSet(i){return M(this,null,function*(){let r=this.getDb();if(r)return at(we(r,this.getSetsLocation()+"/"+i.id),i)})}updateSet(i){return M(this,null,function*(){let r=this.getDb();if(r)return at(we(r,this.getSetsLocation()+"/"+i.id),i)})}deleteSet(i){return M(this,null,function*(){let r=this.getDb();if(r)return Nr(we(r,this.getSetsLocation()+"/"+i))})}};e.\u0275fac=function(r){return new(r||e)(Q(me),Q(Nt),Q(Le))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Oe=(()=>{let e=class e{constructor(i,r,s){this.dbService=i,this.envService=r,this.notificationService=s,this.cards=null,this.cardAdded=new z,this.typeOptions=["masculine","feminine","neuter","verb","other"]}loadCards(){return M(this,null,function*(){return this.cards&&this.cards.length>0?this.cards:this.dbService.getCards().then(i=>(this.cards=Object.values(i),this.notificationService.push({message:"Cards loaded!",success:!0}),this.cards))})}getCard(i){let r=this.findCardIndex(i);return r===null||!this.cards?null:this.cards[r]}getCards(){return this.cards?this.cards:[]}getStarred(){return this.cards?this.cards.filter(i=>i.starred):[]}findCardIndex(i){let r=this.getCards(),s=0,o=r.length-1;for(;o>=s;){let a=Math.floor((o+s)/2),l=r[a];if(l.id===i)return a;l.id<i?s=a+1:l.id>i&&(o=a-1)}return this.notificationService.push({message:"Couldn't find card!",success:!1}),null}update(i,r){return M(this,null,function*(){if(this.cards=yield this.loadCards(),this.envService.isLocal()){this.cards[r]=i;return}return this.dbService.updateCard(i).then(()=>{this.cards&&(this.cards[r]=i)})})}add(i){return M(this,null,function*(){if(this.cards=yield this.loadCards(),i.id=this.cards[this.cards.length-1].id+1,this.envService.isLocal()){this.cards.push(i),this.cardAdded.next(i);return}return this.dbService.addCard(i).then(()=>{this.cards?.push(i),this.cardAdded.next(i)})})}delete(i,r){return M(this,null,function*(){if(this.cards=yield this.loadCards(),this.envService.isLocal()){this.cards.splice(r,1);return}return this.dbService.deleteCard(i).then(()=>{this.cards?.splice(r,1)})})}};e.\u0275fac=function(r){return new(r||e)(Q(Ye),Q(Nt),Q(ce))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var xe=(()=>{let e=class e{constructor(i,r,s,o){this.cardsService=i,this.dbService=r,this.envService=s,this.notificationService=o,this.updated=new z,this.sets=null,this.colorOptions=["plum","lightgreen","palegoldenrod","lightpink","lightblue"]}parse(i){return Object.values(i).map(r=>(r.cards=r.cards?Object.values(r.cards):[],r))}getNextId(){if(!this.sets||this.sets.length===0)return 0;let i=0;return this.sets.forEach(r=>{r.id>i&&(i=r.id)}),i+1}loadSets(){return M(this,null,function*(){return this.sets?this.sets:this.dbService.getSets().then(i=>(this.sets=i?this.parse(i):[],this.sets.sort((r,s)=>r.name.localeCompare(s.name)),this.sets))})}loadSetFromParams(i){return M(this,null,function*(){let r=i.get("setId");return r===null?null:this.getSet(Number.parseInt(r))})}getSets(){return this.sets?this.sets:[]}getSet(i){return M(this,null,function*(){this.sets||(yield this.loadSets());let r=this.sets?.find(s=>s.id===i);return r||null})}getCards(i){return M(this,null,function*(){let r=yield this.getSet(i);if(!r)return[];let s=[];return r.cards.forEach(o=>{let a=this.cardsService.getCard(o);a!==null&&s.push(a)}),s.sort((o,a)=>o.id-a.id)})}add(i){return M(this,null,function*(){if(this.sets=yield this.loadSets(),!this.sets){this.notificationService.push({message:"Failed to add set!",success:!1});return}return this.sets.sort,i.id=this.getNextId(),this.dbService.addSet(i).then(()=>{this.sets?.push(i)})})}updateSet(i){return M(this,null,function*(){return this.dbService.updateSet(i).then(()=>{this.notificationService.push({message:"Set updated!",success:!0});let r=this.sets?.findIndex(s=>s.id===i.id);r&&this.sets&&(this.sets[r]=i),this.updated.next()}).catch(()=>{this.notificationService.push({message:"Failed to update set!",success:!1})})})}deleteSet(i){return M(this,null,function*(){return this.dbService.deleteSet(i).then(()=>{this.notificationService.push({message:"Set deleted!",success:!0});let r=this.sets?.findIndex(s=>s.id===i);r&&this.sets?.splice(r,1)}).catch(r=>{this.notificationService.push({message:"Failed to delete set!",success:!1})})})}};e.\u0275fac=function(r){return new(r||e)(Q(Oe),Q(Ye),Q(Nt),Q(ce))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Ft=(()=>{let e=class e{constructor(){this.setSelectOpened=new z,this.setSelectClosed=new z}open(i){this.setSelectOpened.next(i)}close(){this.setSelectClosed.next()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var id=n=>({backgroundColor:n});function rd(n,e){n&1&&(d(0,"div",19),P(),d(1,"svg",7),m(2,"g",8)(3,"g",9),d(4,"g",10),m(5,"path",20)(6,"path",21),p()()())}function sd(n,e){n&1&&(d(0,"div",19),P(),d(1,"svg",7),m(2,"g",8)(3,"g",9),d(4,"g",10),m(5,"path",22),p()()())}function od(n,e){if(n&1){let t=F();d(0,"div",13)(1,"div",14),y("click",function(){let r=x(t).$implicit,s=_(2);return b(s.toggleSelectionFor(r))}),d(2,"div",15)(3,"div",16),T(4),p(),d(5,"div",17),I(6,rd,7,0,"div",18)(7,sd,6,0,"div",18),p()()()()}if(n&2){let t=e.$implicit,i=_(2);C(),le(ie(5,id,t.color)),C(3),oe(" ",t.name," "),C(2),v("ngIf",!t.cards.includes(i.selection)),C(),v("ngIf",t.cards.includes(i.selection))}}function ad(n,e){if(n&1){let t=F();d(0,"app-modal",1),y("close",function(){x(t);let r=_();return b(r.close())}),d(1,"h4",2),T(2,"Add to set(s)"),p(),d(3,"div",3),I(4,od,8,7,"div",4),p(),d(5,"div",5)(6,"button",6),y("click",function(){x(t);let r=_();return b(r.close())}),P(),d(7,"svg",7),m(8,"g",8)(9,"g",9),d(10,"g",10)(11,"g",11),m(12,"path",12),p()()()(),ee(),d(13,"button",6),y("click",function(){x(t);let r=_();return b(r.close())}),P(),d(14,"svg",7),m(15,"g",8)(16,"g",9),d(17,"g",10)(18,"g",11),m(19,"path",12),p()()()()()()}if(n&2){let t=_();C(4),v("ngForOf",t.sets)}}var sa=(()=>{let e=class e{constructor(i,r){this.setsService=i,this.setSelectService=r,this.subs=[],this.open=!1,this.sets=[]}ngOnInit(){this.subs=[this.setSelectService.setSelectOpened.subscribe(i=>this.handleOpen(i)),this.setSelectService.setSelectClosed.subscribe(()=>this.open=!1)]}handleOpen(i){this.open=!0,this.selection=i,this.setsService.loadSets().then(r=>{this.sets=r})}addSelectionTo(i){i.cards.push(this.selection),this.setsService.updateSet(i)}removeSelectionFrom(i){i.cards.splice(i.cards.findIndex(r=>r===this.selection),1),this.setsService.updateSet(i)}toggleSelectionFor(i){i.cards.includes(this.selection)?this.removeSelectionFrom(i):this.addSelectionTo(i)}close(){this.open=!1}ngOnDestroy(){this.subs.forEach(i=>i.unsubscribe())}};e.\u0275fac=function(r){return new(r||e)(k(xe),k(Ft))},e.\u0275cmp=V({type:e,selectors:[["app-set-select"]],standalone:!0,features:[j],decls:1,vars:1,consts:[["class","container",3,"close",4,"ngIf"],[1,"container",3,"close"],[1,"title"],[1,"select-list"],["class","set-row",4,"ngFor","ngForOf"],[1,"bottom-row"],[1,"icon-btn","close",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["id","Menu / Close_LG"],["id","Vector","d","M21 21L12 12M12 12L3 3M12 12L21.0001 3M12 12L3 21.0001","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"set-row"],[1,"list-card",3,"click"],[1,"row-between"],[2,"max-width","75%"],[1,"col-center"],["class","icon-btn","style","width: 2.5rem; height: 2.5rem;",4,"ngIf"],[1,"icon-btn",2,"width","2.5rem","height","2.5rem"],["d","M11 8C11 7.44772 11.4477 7 12 7C12.5523 7 13 7.44772 13 8V11H16C16.5523 11 17 11.4477 17 12C17 12.5523 16.5523 13 16 13H13V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V13H8C7.44771 13 7 12.5523 7 12C7 11.4477 7.44772 11 8 11H11V8Z","fill","#0F0F0F"],["fill-rule","evenodd","clip-rule","evenodd","d","M23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12ZM3.00683 12C3.00683 16.9668 7.03321 20.9932 12 20.9932C16.9668 20.9932 20.9932 16.9668 20.9932 12C20.9932 7.03321 16.9668 3.00683 12 3.00683C7.03321 3.00683 3.00683 7.03321 3.00683 12Z","fill","#0F0F0F"],["d","M4 12.6111L8.92308 17.5L20 6.5","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"]],template:function(r,s){r&1&&I(0,ad,20,1,"app-modal",0),r&2&&v("ngIf",s.open)},dependencies:[X,Z,pe,gt],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.title[_ngcontent-%COMP%]{margin:.5rem 0 1rem}.select-list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;gap:.5rem;padding:2px}.bottom-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;margin:.25rem 0 -.5rem}.icon[_ngcontent-%COMP%]{width:2rem;height:2rem}"]});let n=e;return n})();var oa=Xe("drop",[Ce("active",ge({top:"0"})),Ce("inactive",ge({top:"-100%"})),ve("active => inactive",_e("200ms ease-out")),ve("inactive => active",_e("200ms ease-in"))]);var ld=n=>({background:n}),aa=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=V({type:e,selectors:[["app-action-slider"]],inputs:{active:"active"},standalone:!0,features:[j],decls:2,vars:5,consts:[[1,"track",3,"ngStyle"]],template:function(r,s){r&1&&(d(0,"div",0),m(1,"div"),p()),r&2&&(v("ngStyle",ie(3,ld,s.active?"lightgreen":"gray")),C(),Fe(s.active?"slider right":"slider left"))},dependencies:[Ur],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:4px;margin-right:4px}.track[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;border-radius:2rem;width:42px;height:24px;box-shadow:0 1px 1px gray}.slider[_ngcontent-%COMP%]{border-radius:2rem;width:18px;height:18px;background:#dedede;box-shadow:1px 1px 2px #00000070}.left[_ngcontent-%COMP%]{transition:all .3s ease;margin-left:4px}.right[_ngcontent-%COMP%]{transition:all .3s ease;margin-left:20px}"]});let n=e;return n})();var ti=(()=>{let e=class e{constructor(){this.selected=!1}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=V({type:e,selectors:[["app-color-choice"]],inputs:{value:"value",selected:"selected"},standalone:!0,features:[j],decls:1,vars:4,template:function(r,s){r&1&&m(0,"div"),r&2&&(Fe(s.selected?"choice selected":"choice"),ut("background-color",s.value))},styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.choice[_ngcontent-%COMP%]{width:4rem;height:3rem;border-radius:10px;box-shadow:0 1px 2px gray}.choice[_ngcontent-%COMP%]:hover{cursor:pointer}.selected[_ngcontent-%COMP%]{outline:2px solid black}"]});let n=e;return n})();var Ke=(()=>{let e=class e{transform(i){switch(i){case"masculine":return"lightblue";case"feminine":return"lightpink";case"neuter":return"palegoldenrod";case"verb":return"plum";case"other":return"lightgreen";default:return"gray"}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275pipe=hn({name:"typeColor",type:e,pure:!0,standalone:!0});let n=e;return n})();var la=(()=>{let e=class e{constructor(i){this.dbService=i}getBase(){return M(this,null,function*(){if(this.base)return this.base;let i=yield this.dbService.getBaseLanguage();return typeof i=="string"?(this.base=i,i):""})}getGoal(){return M(this,null,function*(){if(this.goal)return this.goal;let i=yield this.dbService.getGoalLanguage();return typeof i=="string"?(this.goal=i,i):""})}};e.\u0275fac=function(r){return new(r||e)(Q(Ye))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var ni=(()=>{let e=class e{constructor(i){this.languageService=i}name(i){switch(i){case"en":return"English";case"es":return"Spanish";case"de":return"German";default:return"Unknown"}}transform(i){return M(this,null,function*(){switch(i){case"base":{let r=this.name(yield this.languageService.getBase());return r==="Unknown"?"Base":r}case"goal":{let r=this.name(yield this.languageService.getGoal());return r==="Unknown"?"Goal":r}default:return"Unknown"}})}};e.\u0275fac=function(r){return new(r||e)(k(la,16))},e.\u0275pipe=hn({name:"language",type:e,pure:!0,standalone:!0});let n=e;return n})();var Ne=(()=>{let e=class e{constructor(){this.settingsOpen=new z,this.addCardOpen=new z,this.addSetOpen=new z}openSettings(){this.settingsOpen.next(!0)}closeSettings(){this.settingsOpen.next(!1)}openAddCard(){this.addCardOpen.next(!0)}closeAddCard(){this.addCardOpen.next(!1)}openAddSet(){this.addSetOpen.next(!0)}closeAddSet(){this.addSetOpen.next(!1)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var At=(()=>{let e=class e{constructor(i,r){this.dbService=i,this.notificationsService=r,this.settings={base_front:!0,deal_starred:!1,deck_size:10},this.loading=!0,this.loaded=new z,this.dealStarredChanged=new z,this.dbService.getSettings().then(s=>{this.loading=!1,this.loaded.next(),s&&(this.settings=s)})}update(i){return M(this,null,function*(){return this.dbService.setSettings(i).then(()=>{this.settings=i,this.notificationsService.push({message:"Settings updated!",success:!0})}).catch(()=>{this.notificationsService.push({message:"Failed to update settings!",success:!1})})})}getDealStarred(){return this.settings.deal_starred}setDealStarred(i){let r=ct(Re({},this.settings),{deal_starred:i});this.update(r).then(()=>this.dealStarredChanged.next())}getBaseFront(){return this.settings.base_front}setBaseFront(i){let r=ct(Re({},this.settings),{base_front:i});this.update(r)}getDeckSize(){return this.settings.deck_size}setDeckSize(i){let r=ct(Re({},this.settings),{deck_size:i});this.update(r)}};e.\u0275fac=function(r){return new(r||e)(Q(Ye),Q(ce))},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function dd(n,e){if(n&1){let t=F();d(0,"form",1)(1,"div",12)(2,"p",13),T(3,"Deal from starred cards only?"),p(),d(4,"app-action-slider",14),y("click",function(){x(t);let r=_();return b(r.toggleDealFromStarred())}),p()(),d(5,"div",12)(6,"p",13),T(7),A(8,"language"),A(9,"async"),p(),d(10,"app-action-slider",14),y("click",function(){x(t);let r=_();return b(r.toggleBaseFront())}),p()(),d(11,"div",12),m(12,"input",15),d(13,"button",16),y("click",function(){x(t);let r=_();return b(r.setDeckSize())}),T(14,"Set deck size"),p()()()}if(n&2){let t=_();v("formGroup",t.settingsForm),C(4),v("active",t.getDealFromStarred()),C(3),oe("",D(9,6,D(8,4,"base"))," on front?"),C(3),v("active",t.getBaseFront())}}function ud(n,e){if(n&1&&(d(0,"option",25),A(1,"typeColor"),T(2),p()),n&2){let t=e.$implicit;ut("background",D(1,4,t)),v("ngValue",t),C(2),fe(t)}}function hd(n,e){if(n&1&&(d(0,"form",2)(1,"h2"),T(2,"Add card"),p(),m(3,"input",17),A(4,"language"),A(5,"async"),m(6,"input",18),A(7,"language"),A(8,"async"),d(9,"select",19),I(10,ud,3,6,"option",20),p(),m(11,"textarea",21),A(12,"language"),A(13,"async"),m(14,"textarea",22),A(15,"language"),A(16,"async"),m(17,"textarea",23),A(18,"language"),A(19,"async"),m(20,"textarea",24),A(21,"language"),A(22,"async"),p()),n&2){let t=_();v("formGroup",t.addCardForm),C(3),v("placeholder",D(5,10,D(4,8,"base"))),C(3),v("placeholder",D(8,14,D(7,12,"goal"))),C(4),v("ngForOf",t.typeOptions),C(),v("placeholder",D(13,18,D(12,16,"goal"))+" sentence 1"),C(3),v("placeholder",D(16,22,D(15,20,"base"))+" sentence 1"),C(3),v("placeholder",D(19,26,D(18,24,"goal"))+" sentence 2"),C(3),v("placeholder",D(22,30,D(21,28,"base"))+" sentence 2")}}function fd(n,e){if(n&1){let t=F();d(0,"app-color-choice",29),y("click",function(){let r=x(t).$implicit,s=_(2);return b(s.addSetForm.patchValue({color:r}))}),p()}if(n&2){let t,i=e.$implicit,r=_(2);v("value",i)("selected",((t=r.addSetForm.get("color"))==null?null:t.value)===i)}}function pd(n,e){if(n&1&&(d(0,"form",2)(1,"h2"),T(2,"Add set"),p(),m(3,"input",26),d(4,"div",27),I(5,fd,1,2,"app-color-choice",28),p()()),n&2){let t=_();v("formGroup",t.addSetForm),C(5),v("ngForOf",t.getColorOptions())}}function md(n,e){if(n&1){let t=F();d(0,"button",4),y("click",function(){x(t);let r=_();return b(r.save())}),P(),d(1,"svg",5),m(2,"g",6)(3,"g",7),d(4,"g",8),m(5,"path",30),p()()()}}var ca=(()=>{let e=class e{constructor(i,r,s,o,a){this.cardsService=i,this.menuService=r,this.notificationsService=s,this.setsService=o,this.settingsService=a,this.subs=[],this.dropState="inactive",this.settingsOpen=!1,this.addCardOpen=!1,this.addSetOpen=!1,this.settingsForm=new Ge({deckSize:new W(this.settingsService.getDeckSize(),[re.min(1),re.required])}),this.addCardForm=new Ge({base:new W(null,[re.required,re.minLength(1)]),goal:new W(null,re.required),type:new W("masculine",re.required),goal_sent_1:new W(""),base_sent_1:new W(""),goal_sent_2:new W(""),base_sent_2:new W("")}),this.addSetForm=new Ge({name:new W(null,re.required),color:new W(null,re.required)})}ngOnInit(){this.subs=[this.menuService.settingsOpen.subscribe(i=>this.settingsOpen=i),this.menuService.addCardOpen.subscribe(i=>this.addCardOpen=i),this.menuService.addSetOpen.subscribe(i=>this.addSetOpen=i),this.settingsService.loaded.subscribe(()=>{this.settingsForm.patchValue({deckSize:this.settingsService.getDeckSize()})})],this.typeOptions=this.cardsService.typeOptions}resetAddForm(){this.addCardForm.reset(),this.addCardForm.patchValue({type:"masculine"})}close(){this.addCardOpen&&this.resetAddForm(),this.addSetOpen&&this.addSetForm.reset(),this.menuService.closeSettings(),this.menuService.closeAddCard(),this.menuService.closeAddSet()}save(){this.addCardOpen?this.addCard():this.addSetOpen&&this.addSet()}addCard(){let i={id:-1,base:this.addCardForm.controls.base.value?this.addCardForm.controls.base.value:"",goal:this.addCardForm.controls.goal.value?this.addCardForm.controls.goal.value:"",type:this.addCardForm.controls.type.value?this.addCardForm.controls.type.value:"other",goal_sent_1:this.addCardForm.controls.goal_sent_1.value?this.addCardForm.controls.goal_sent_1.value:"",base_sent_1:this.addCardForm.controls.base_sent_1.value?this.addCardForm.controls.base_sent_1.value:"",goal_sent_2:this.addCardForm.controls.goal_sent_2.value?this.addCardForm.controls.goal_sent_2.value:"",base_sent_2:this.addCardForm.controls.base_sent_2.value?this.addCardForm.controls.base_sent_2.value:"",starred:!1};this.cardsService.add(i).then(()=>{this.close(),this.notificationsService.push({message:"Card added!",success:!0})}).catch(r=>{this.notificationsService.push({message:"Error adding card to db! "+r,success:!1})})}getColorOptions(){return this.setsService.colorOptions}addSet(){let i=this.addSetForm.value,r={id:-1,name:i.name?i.name:"",color:i.color?i.color:"lightgray",cards:[]};this.setsService.add(r).then(()=>this.close())}getDropState(){return this.settingsOpen||this.addCardOpen||this.addSetOpen?"active":"inactive"}getDealFromStarred(){return this.settingsService.getDealStarred()}toggleDealFromStarred(){this.settingsService.setDealStarred(!this.settingsService.getDealStarred())}getBaseFront(){return this.settingsService.getBaseFront()}toggleBaseFront(){this.settingsService.setBaseFront(!this.settingsService.getBaseFront())}setDeckSize(){let i=this.settingsForm.controls.deckSize.value;i&&this.settingsService.setDeckSize(i)}ngOnDestroy(){this.subs.forEach(i=>i.unsubscribe())}};e.\u0275fac=function(r){return new(r||e)(k(Oe),k(Ne),k(ce),k(xe),k(At))},e.\u0275cmp=V({type:e,selectors:[["app-menu"]],standalone:!0,features:[j],decls:20,vars:3,consts:[[1,"menu-container"],[3,"formGroup"],[1,"add-form",3,"formGroup"],[1,"navbar"],[1,"icon-btn",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["id","Menu / Close_LG"],["id","Vector","d","M21 21L12 12M12 12L3 3M12 12L21.0001 3M12 12L3 21.0001","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["class","icon-btn",3,"click",4,"ngIf"],[1,"row"],[1,"label",2,"margin-right","1rem"],[3,"click","active"],["type","number","placeholder","deck size","formControlName","deckSize",2,"margin","0"],[1,"btn",2,"margin","0",3,"click"],["type","text","formControlName","base",1,"border-input",3,"placeholder"],["type","text","formControlName","goal",1,"border-input",3,"placeholder"],["formControlName","type",1,"border-input"],[3,"ngValue","background",4,"ngFor","ngForOf"],["type","text","formControlName","goal_sent_1",1,"border-input",3,"placeholder"],["type","text","formControlName","base_sent_1",1,"border-input",3,"placeholder"],["type","text","formControlName","goal_sent_2",1,"border-input",3,"placeholder"],["type","text","formControlName","base_sent_2",1,"border-input",3,"placeholder"],[3,"ngValue"],["type","text","formControlName","name","placeholder","Name",1,"border-input"],[1,"color-container"],[3,"value","selected","click",4,"ngFor","ngForOf"],[3,"click","value","selected"],["fill-rule","evenodd","clip-rule","evenodd","d","M18.1716 1C18.702 1 19.2107 1.21071 19.5858 1.58579L22.4142 4.41421C22.7893 4.78929 23 5.29799 23 5.82843V20C23 21.6569 21.6569 23 20 23H4C2.34315 23 1 21.6569 1 20V4C1 2.34315 2.34315 1 4 1H18.1716ZM4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21L5 21L5 15C5 13.3431 6.34315 12 8 12L16 12C17.6569 12 19 13.3431 19 15V21H20C20.5523 21 21 20.5523 21 20V6.82843C21 6.29799 20.7893 5.78929 20.4142 5.41421L18.5858 3.58579C18.2107 3.21071 17.702 3 17.1716 3H17V5C17 6.65685 15.6569 8 14 8H10C8.34315 8 7 6.65685 7 5V3H4ZM17 21V15C17 14.4477 16.5523 14 16 14L8 14C7.44772 14 7 14.4477 7 15L7 21L17 21ZM9 3H15V5C15 5.55228 14.5523 6 14 6H10C9.44772 6 9 5.55228 9 5V3Z","fill","#0F0F0F"]],template:function(r,s){r&1&&(d(0,"div",0),I(1,dd,15,8,"form",1)(2,hd,23,32,"form",2)(3,pd,6,2,"form",2),d(4,"div",3)(5,"button",4),y("click",function(){return s.close()}),P(),d(6,"svg",5),m(7,"g",6)(8,"g",7),d(9,"g",8)(10,"g",9),m(11,"path",10),p()()()(),I(12,md,6,0,"button",11),ee(),d(13,"button",4),y("click",function(){return s.close()}),P(),d(14,"svg",5),m(15,"g",6)(16,"g",7),d(17,"g",8)(18,"g",9),m(19,"path",10),p()()()()()()),r&2&&(v("@drop",s.getDropState()),C(),ne(s.settingsOpen?1:s.addCardOpen?2:s.addSetOpen?3:-1),C(11),v("ngIf",s.addCardOpen&&s.addCardForm.valid||s.addSetOpen&&s.addSetForm.valid))},dependencies:[X,Z,pe,_n,Be,pt,xn,bn,Ve,ds,wn,je,ft,mt,_t,aa,ti,Ke,ni],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.menu-container[_ngcontent-%COMP%]{position:absolute;left:0;display:flex;flex-direction:column;justify-content:flex-end;width:100%;height:100%;background:#dedede;z-index:1}.row[_ngcontent-%COMP%]{margin:0 1rem;display:flex;flex-direction:row;justify-content:space-between}.add-form[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:flex-end;margin:1rem 0;text-align:center;gap:.5rem}"],data:{animation:[oa]}});let n=e;return n})();var _d=["*"],$e=(()=>{let e=class e{constructor(i){this.menuService=i}ngOnInit(){}settingsPressed(){this.menuService.openSettings()}};e.\u0275fac=function(r){return new(r||e)(k(Ne))},e.\u0275cmp=V({type:e,selectors:[["app-navbar"]],standalone:!0,features:[j],ngContentSelectors:_d,decls:13,vars:0,consts:[[1,"navbar"],["title","Settings",1,"icon-btn",3,"click"],["viewBox","-0.5 0 25 25","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M12 7.82001H22","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M2 7.82001H4","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M20 16.82H22","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M2 16.82H12","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M8 11.82C10.2091 11.82 12 10.0291 12 7.82001C12 5.61087 10.2091 3.82001 8 3.82001C5.79086 3.82001 4 5.61087 4 7.82001C4 10.0291 5.79086 11.82 8 11.82Z","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["d","M16 20.82C18.2091 20.82 20 19.0291 20 16.82C20 14.6109 18.2091 12.82 16 12.82C13.7909 12.82 12 14.6109 12 16.82C12 19.0291 13.7909 20.82 16 20.82Z","stroke","#000000","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"]],template:function(r,s){r&1&&(pn(),d(0,"div",0),mn(1),d(2,"button",1),y("click",function(){return s.settingsPressed()}),P(),d(3,"svg",2),m(4,"g",3)(5,"g",4),d(6,"g",5),m(7,"path",6)(8,"path",7)(9,"path",8)(10,"path",9)(11,"path",10)(12,"path",11),p()()()())},styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.navbar[_ngcontent-%COMP%]{border-radius:10px 10px 0 0;border-bottom:none;box-shadow:0 2px 4px #000;padding-top:.5rem}"]});let n=e;return n})();var Dt=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=V({type:e,selectors:[["app-loading"]],standalone:!0,features:[j],decls:2,vars:0,consts:[[1,"loading-container"],[1,"spinner"]],template:function(r,s){r&1&&(d(0,"div",0),m(1,"div",1),p())},styles:[".loading-container[_ngcontent-%COMP%]{width:100%;height:100%;position:fixed;top:25%;display:flex;flex-direction:row;justify-content:center}.spinner[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:100%;animation:_ngcontent-%COMP%_morph 1s alternate infinite}@keyframes _ngcontent-%COMP%_morph{0%{background:plum;border-radius:50%;margin-top:0}to{background:#90ee90;border-radius:100%;margin-top:2rem}}"]});let n=e;return n})();var da=Xe("flip",[Ce("active",ge({transform:"rotateY(180deg)"})),Ce("inactive",ge({transform:"rotateY(0)"})),ve("active => inactive",_e("300ms ease-out")),ve("inactive => active",_e("300ms ease-in"))]),ua=Xe("swipeRight",[Ce("active",ge({transform:"rotateZ(90deg)",translate:"150% -100%"})),Ce("inactive",ge({transform:"rotateZ(0deg)",translate:"0% 0%"})),ve("active => inactive",_e("300ms ease-out")),ve("inactive => active",_e("300ms ease-in"))]),ha=Xe("swipeLeft",[Ce("active",ge({transform:"rotateZ(-90deg)",translate:"-150% -100%"})),Ce("inactive",ge({transform:"rotateZ(0deg)",translate:"0% 0%"})),ve("active => inactive",_e("400ms ease-out")),ve("inactive => active",_e("400ms ease-in"))]),fa=Xe("fadeIn",[Ce("active",ge({opacity:"100%"})),Ce("inactive",ge({opacity:"0%"})),ve("active => inactive",_e("200ms ease-out")),ve("inactive => active",_e("200ms ease-in"))]);var gd=n=>({background:n});function Cd(n,e){if(n&1){let t=F();d(0,"app-modal"),T(1," Delete card? "),d(2,"div",3)(3,"button",4),y("click",function(r){x(t);let s=_();return b(s.delete(r))}),T(4,"yes"),p(),d(5,"button",5),y("click",function(){x(t);let r=_();return b(r.showDelete=!1)}),T(6,"no"),p()()()}}function vd(n,e){if(n&1&&(d(0,"div"),T(1),p()),n&2){let t=_();Fe(t.flipped?"card-content":"card-content back"),C(),oe(" ",t.flipped?t.getFront():t.getBack()," ")}}function yd(n,e){n&1&&(P(),d(0,"svg",14),m(1,"g",8)(2,"g",9),d(3,"g",10),m(4,"path",20),p()())}function wd(n,e){n&1&&(P(),d(0,"svg",15),m(1,"g",8)(2,"g",9),d(3,"g",10),m(4,"path",21),p()())}function xd(n,e){if(n&1){let t=F();d(0,"div")(1,"button",6),y("click",function(r){x(t);let s=_();return b(s.editTapped(r))}),P(),d(2,"svg",7),m(3,"g",8)(4,"g",9),d(5,"g",10),m(6,"path",11)(7,"path",12),p()()(),ee(),d(8,"button",13),y("click",function(r){x(t);let s=_();return b(s.starTapped(r,s.card))}),I(9,yd,5,0,":svg:svg",14)(10,wd,5,0,":svg:svg",15),p(),d(11,"button",6),y("click",function(r){x(t);let s=_();return b(s.infoTapped(r))}),P(),d(12,"svg",16),m(13,"g",8)(14,"g",9),d(15,"g",10),m(16,"path",17)(17,"path",18)(18,"path",19),p()()()()}if(n&2){let t=_();Fe(t.flipped?"btn-row":"btn-row back"),C(9),ne(t.card.starred?9:10)}}function bd(n,e){if(n&1&&(d(0,"option",32),A(1,"typeColor"),T(2),p()),n&2){let t=e.$implicit,i=_(3);ut("background",D(1,4,t)),v("selected",t===i.card.type),C(2),fe(t)}}function Sd(n,e){if(n&1&&(d(0,"div")(1,"form",23),m(2,"input",24),A(3,"language"),A(4,"async"),m(5,"input",25),A(6,"language"),A(7,"async"),d(8,"select",26),I(9,bd,3,6,"option",27),p(),m(10,"textarea",28),A(11,"language"),A(12,"async"),m(13,"textarea",29),A(14,"language"),A(15,"async"),m(16,"textarea",30),A(17,"language"),A(18,"async"),m(19,"textarea",31),A(20,"language"),A(21,"async"),p()()),n&2){let t=_(2);C(),v("formGroup",t.editForm),C(),v("placeholder",D(4,11,D(3,9,"base"))),C(3),v("placeholder",D(7,15,D(6,13,"goal"))),C(3),v("value",t.card.type),C(),v("ngForOf",t.typeOptions),C(),v("placeholder",D(12,19,D(11,17,"goal"))+" sentence 1"),C(3),v("placeholder",D(15,23,D(14,21,"base"))+" sentence 1"),C(3),v("placeholder",D(18,27,D(17,25,"goal"))+" sentence 2"),C(3),v("placeholder",D(21,31,D(20,29,"base"))+" sentence 2")}}function kd(n,e){if(n&1&&(d(0,"div")(1,"p",33),T(2),p(),d(3,"p",34),T(4),p(),d(5,"p",33),T(6),p(),d(7,"p",34),T(8),p()()),n&2){let t=_(2);C(2),fe(t.card.goal_sent_1),C(2),fe(t.card.base_sent_1),C(2),fe(t.card.goal_sent_2),C(2),fe(t.card.base_sent_2)}}function Md(n,e){if(n&1){let t=F();d(0,"button",39),y("click",function(r){x(t);let s=_(3);return b(s.saveEdit(r))}),P(),d(1,"svg",16),m(2,"g",8)(3,"g",9),d(4,"g",10),m(5,"path",40),p()()()}if(n&2){let t=_(3);v("disabled",t.editForm.invalid)}}function Td(n,e){if(n&1){let t=F();d(0,"button",6),y("click",function(r){x(t);let s=_(3);return b(s.delete(r))}),P(),d(1,"svg",41),m(2,"g",8)(3,"g",9),d(4,"g",10),m(5,"path",42),p()()()}}function Ed(n,e){if(n&1){let t=F();d(0,"div",3)(1,"button",6),y("click",function(r){x(t);let s=_(2);return b(s.menuClose(r))}),P(),d(2,"svg",35),m(3,"g",8)(4,"g",9),d(5,"g",10),m(6,"path",36),p()()(),I(7,Md,6,1,"button",37)(8,Td,6,0,"button",38),p()}if(n&2){let t=_(2);C(7),v("ngIf",t.showEdit&&t.editForm.valid),C(),v("ngIf",t.showEdit)}}function Pd(n,e){if(n&1){let t=F();d(0,"span"),y("@fadeIn.done",function(){x(t);let r=_();return b(r.fadeInState==="inactive"?r.revealCard():null)}),I(1,Sd,22,33,"div",0)(2,kd,9,4,"div",0)(3,Ed,9,2,"div",22),p()}if(n&2){let t=_();Fe(t.flipped?"card-menu":"card-menu back"),v("@fadeIn",t.fadeInState),C(),v("ngIf",t.showEdit),C(),v("ngIf",t.showInfo),C(),v("ngIf",!t.showCard)}}var ii=(()=>{let e=class e{constructor(i,r){this.cardService=i,this.setSelectService=r,this.onSwiped=new dt,this.onUpdated=new dt,this.onDeleted=new dt,this.touchStart=null,this.flipState="inactive",this.swipeRightState="inactive",this.swipeLeftState="inactive",this.fadeInState="inactive",this.flipped=!1,this.flipping=!1,this.showEdit=!1,this.showCard=!0,this.showInfo=!1,this.showDelete=!1}ngOnInit(){this.typeOptions=this.cardService.typeOptions,this.editForm=new Ge({base:new W(this.card.base,re.required),goal:new W(this.card.goal,re.required),type:new W(this.card.type,re.required),goal_sent_1:new W(this.card.goal_sent_1),base_sent_1:new W(this.card.base_sent_1),goal_sent_2:new W(this.card.goal_sent_2),base_sent_2:new W(this.card.base_sent_2)})}handleTouchStart(i){this.touchStart=i}handleTouchEnd(i){this.touchStart&&(this.showCard&&this.handleSwipe({start:this.touchStart,end:i}),this.touchStart=null)}handleKeyDown(i){this.showCard&&(i.key==="ArrowUp"||i.key==="ArrowDown"?this.tap():i.key==="ArrowRight"?this.swipeRight():i.key==="ArrowLeft"&&this.swipeLeft())}handleTouch(){this.tap()}handleSwipe(i){let r=i.end.changedTouches[0].pageX-i.start.changedTouches[0].pageX;Math.abs(r)>100&&(r>0?this.swipeRight():this.swipeLeft())}getFront(){return this.baseFront?this.card.base:this.card.goal}getBack(){return this.baseFront?this.card.goal:this.card.base}tap(){this.showCard&&(this.flipState=this.flipState==="inactive"?"active":"inactive")}menuClose(i){i.stopPropagation(),this.fade()}saveEdit(i){this.onUpdated.emit(Re(Re({},this.card),this.editForm.value)),this.menuClose(i)}delete(i){if(i.stopPropagation(),!this.showDelete){this.showDelete=!0;return}this.fade(),this.onDeleted.emit(this.card)}revealCard(){this.showEdit=!1,this.showCard=!0,this.showInfo=!1}editTapped(i){i.stopPropagation(),this.fade(),this.showEdit=!0,this.showCard=!1,this.showInfo=!1}starTapped(i,r){i.stopPropagation(),this.setSelectService.open(r.id)}infoTapped(i){i.stopPropagation(),this.fade(),this.showEdit=!1,this.showCard=!1,this.showInfo=!0}swipeRight(){this.swipeRightState=this.swipeRightState==="inactive"?"active":"inactive"}swipeLeft(){this.swipeLeftState=this.swipeLeftState==="inactive"?"active":"inactive"}fade(){this.fadeInState=this.fadeInState==="inactive"?"active":"inactive"}emitSwiped(i){i.fromState==="inactive"&&i.toState==="active"&&(i.triggerName==="swipeRight"?this.onSwiped.emit(!0):this.onSwiped.emit(!1))}};e.\u0275fac=function(r){return new(r||e)(k(Oe),k(Ft))},e.\u0275cmp=V({type:e,selectors:[["app-card"]],hostBindings:function(r,s){r&1&&y("touchstart",function(a){return s.handleTouchStart(a)},!1,fn)("touchend",function(a){return s.handleTouchEnd(a)},!1,fn)("keydown",function(a){return s.handleKeyDown(a)},!1,fn)},inputs:{card:"card",color:"color",baseFront:"baseFront"},outputs:{onSwiped:"onSwiped",onUpdated:"onUpdated",onDeleted:"onDeleted"},standalone:!0,features:[j],decls:5,vars:13,consts:[[4,"ngIf"],["id","container",3,"click"],[3,"class",4,"ngIf"],[1,"btn-row"],[1,"btn","submit",3,"click"],[1,"btn","cancel",3,"click"],[1,"icon-btn",3,"click"],["viewBox","0 0 1024 1024","xmlns","http://www.w3.org/2000/svg","fill","#000000"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["fill","#000000","d","M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"],["fill","#000000","d","m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"],[1,"icon-btn","star",3,"click"],["fill","#ffff00","viewBox","0 0 1920 1920","xmlns","http://www.w3.org/2000/svg","stroke","#ffff00"],["fill","#000000","viewBox","0 0 1920 1920","xmlns","http://www.w3.org/2000/svg"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M12 17.75C12.4142 17.75 12.75 17.4142 12.75 17V11C12.75 10.5858 12.4142 10.25 12 10.25C11.5858 10.25 11.25 10.5858 11.25 11V17C11.25 17.4142 11.5858 17.75 12 17.75Z","fill","#000000"],["d","M12 7C12.5523 7 13 7.44772 13 8C13 8.55228 12.5523 9 12 9C11.4477 9 11 8.55228 11 8C11 7.44772 11.4477 7 12 7Z","fill","#000000"],["fill-rule","evenodd","clip-rule","evenodd","d","M1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.9371 1.25 22.75 6.06294 22.75 12C22.75 17.9371 17.9371 22.75 12 22.75C6.06294 22.75 1.25 17.9371 1.25 12ZM12 2.75C6.89137 2.75 2.75 6.89137 2.75 12C2.75 17.1086 6.89137 21.25 12 21.25C17.1086 21.25 21.25 17.1086 21.25 12C21.25 6.89137 17.1086 2.75 12 2.75Z","fill","#000000"],["d","M1915.918 737.475c-10.955-33.543-42.014-56.131-77.364-56.131h-612.029l-189.063-582.1v-.112C1026.394 65.588 995.335 43 959.984 43c-35.237 0-66.41 22.588-77.365 56.245L693.443 681.344H81.415c-35.35 0-66.41 22.588-77.365 56.131-10.955 33.544.79 70.137 29.478 91.03l495.247 359.831-189.177 582.212c-10.955 33.657 1.13 70.25 29.817 90.918 14.23 10.278 30.946 15.487 47.66 15.487 16.716 0 33.432-5.21 47.775-15.6l495.134-359.718 495.021 359.718c28.574 20.781 67.087 20.781 95.662.113 28.687-20.668 40.658-57.261 29.703-91.03l-189.176-582.1 495.36-359.83c28.574-20.894 40.433-57.487 29.364-91.03","fill-rule","evenodd"],["d","M1306.181 1110.407c-28.461 20.781-40.32 57.261-29.477 91.03l166.136 511.398-435.05-316.122c-28.686-20.781-67.086-20.781-95.66 0l-435.05 316.122 166.25-511.623c10.842-33.544-1.017-70.024-29.591-90.805L178.577 794.285h537.825c35.351 0 66.523-22.701 77.365-56.245l166.25-511.51 166.136 511.397a81.155 81.155 0 0 0 77.365 56.358h537.939l-435.276 316.122Zm609.77-372.819c-10.956-33.656-42.014-56.244-77.365-56.244h-612.141l-189.064-582.1C1026.426 65.589 995.367 43 960.017 43c-35.351 0-66.523 22.588-77.365 56.245L693.475 681.344H81.335c-35.351 0-66.41 22.588-77.366 56.244-10.842 33.657 1.017 70.137 29.591 90.918l495.247 359.718-189.29 582.211c-10.842 33.657 1.017 70.137 29.704 90.918 14.23 10.39 31.059 15.586 47.661 15.586 16.829 0 33.657-5.195 47.887-15.699l495.248-359.718 495.02 359.718c28.575 20.894 67.088 20.894 95.775.113 28.574-20.781 40.433-57.261 29.59-91.03l-189.289-582.1 495.247-359.717c28.687-20.781 40.546-57.261 29.59-90.918Z","fill-rule","evenodd"],["class","btn-row",4,"ngIf"],[1,"edit-form",3,"formGroup"],["type","text","formControlName","base",1,"border-input",3,"placeholder"],["type","text","formControlName","goal",1,"border-input",3,"placeholder"],["formControlName","type",1,"border-input",3,"value"],[3,"selected","background",4,"ngFor","ngForOf"],["type","text","formControlName","goal_sent_1",1,"border-input",3,"placeholder"],["type","text","formControlName","base_sent_1",1,"border-input",3,"placeholder"],["type","text","formControlName","goal_sent_2",1,"border-input",3,"placeholder"],["type","text","formControlName","base_sent_2",1,"border-input",3,"placeholder"],[3,"selected"],[1,"sent-ger"],[1,"sent-eng"],["fill","#000000","viewBox","0 0 1024 1024","xmlns","http://www.w3.org/2000/svg"],["d","M222.927 580.115l301.354 328.512c24.354 28.708 20.825 71.724-7.883 96.078s-71.724 20.825-96.078-7.883L19.576 559.963a67.846 67.846 0 01-13.784-20.022 68.03 68.03 0 01-5.977-29.488l.001-.063a68.343 68.343 0 017.265-29.134 68.28 68.28 0 011.384-2.6 67.59 67.59 0 0110.102-13.687L429.966 21.113c25.592-27.611 68.721-29.247 96.331-3.656s29.247 68.721 3.656 96.331L224.088 443.784h730.46c37.647 0 68.166 30.519 68.166 68.166s-30.519 68.166-68.166 68.166H222.927z"],["class","icon-btn",3,"disabled","click",4,"ngIf"],["class","icon-btn",3,"click",4,"ngIf"],[1,"icon-btn",3,"click","disabled"],["fill-rule","evenodd","clip-rule","evenodd","d","M18.1716 1C18.702 1 19.2107 1.21071 19.5858 1.58579L22.4142 4.41421C22.7893 4.78929 23 5.29799 23 5.82843V20C23 21.6569 21.6569 23 20 23H4C2.34315 23 1 21.6569 1 20V4C1 2.34315 2.34315 1 4 1H18.1716ZM4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21L5 21L5 15C5 13.3431 6.34315 12 8 12L16 12C17.6569 12 19 13.3431 19 15V21H20C20.5523 21 21 20.5523 21 20V6.82843C21 6.29799 20.7893 5.78929 20.4142 5.41421L18.5858 3.58579C18.2107 3.21071 17.702 3 17.1716 3H17V5C17 6.65685 15.6569 8 14 8H10C8.34315 8 7 6.65685 7 5V3H4ZM17 21V15C17 14.4477 16.5523 14 16 14L8 14C7.44772 14 7 14.4477 7 15L7 21L17 21ZM9 3H15V5C15 5.55228 14.5523 6 14 6H10C9.44772 6 9 5.55228 9 5V3Z","fill","#0F0F0F"],["viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg","fill","none"],["fill","#000000","fill-rule","evenodd","d","M7 1a2 2 0 00-2 2v2H2a1 1 0 000 2h.884c.036.338.078.754.12 1.213.11 1.202.218 2.664.218 3.787 0 1.47-.183 3.508-.315 4.776a2.015 2.015 0 002 2.224h10.186a2.015 2.015 0 002-2.224c-.132-1.268-.315-3.306-.315-4.776 0-1.123.107-2.585.218-3.787.042-.459.084-.875.12-1.213H18a1 1 0 100-2h-3V3a2 2 0 00-2-2H7zm6 4V3H7v2h6zM4.996 8.03c-.035-.378-.07-.728-.101-1.03h10.21a81.66 81.66 0 00-.1 1.03c-.112 1.212-.227 2.75-.227 3.97 0 1.584.194 3.714.325 4.982v.007a.02.02 0 01-.005.008l-.003.003H4.905a.024.024 0 01-.008-.01v-.008c.131-1.268.325-3.398.325-4.982 0-1.22-.115-2.758-.226-3.97zM8 8a1 1 0 011 1v6a1 1 0 11-2 0V9a1 1 0 011-1zm5 1a1 1 0 10-2 0v6a1 1 0 102 0V9z"]],template:function(r,s){r&1&&(I(0,Cd,7,0,"app-modal",0),d(1,"div",1),y("click",function(){return s.handleTouch()})("@flip.start",function(){return s.flipping=!0})("@flip.done",function(){return s.flipped=!s.flipped,s.flipping=!1})("@swipeRight.done",function(a){return s.emitSwiped(a)})("@swipeLeft.done",function(a){return s.emitSwiped(a)}),I(2,vd,2,3,"div",2)(3,xd,19,3,"div",2)(4,Pd,4,6,"span",2),p()),r&2&&(v("ngIf",s.showDelete),C(),le(ie(11,gd,s.color)),Fe(s.flipped?"card":"card back"),v("@flip",s.flipState)("@swipeRight",s.swipeRightState)("@swipeLeft",s.swipeLeftState),C(),v("ngIf",!s.flipping&&s.showCard),C(),v("ngIf",!s.flipping&&s.showCard),C(),v("ngIf",s.showEdit||s.showInfo))},dependencies:[X,Z,pe,_n,Be,pt,xn,bn,Ve,wn,je,ft,mt,_t,Ke,ni,gt],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}[_nghost-%COMP%]{width:100%}.card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:center;height:100%;border-radius:10px;box-shadow:0 1px 2px gray;word-wrap:break-word;overflow-y:scroll}.card[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;height:100%;font-size:32px;padding:1rem}.back[_ngcontent-%COMP%]{transform:rotateY(180deg)}.star[_ngcontent-%COMP%]{width:3.5rem;height:3.5rem}.filled[_ngcontent-%COMP%]{background:#ff0}.btn-row[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;justify-content:space-between;margin-bottom:.25rem}.card-menu[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;justify-content:space-between;margin:1rem 1rem 0}.edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;gap:.5rem}.sent-ger[_ngcontent-%COMP%]{font-size:30px;font-weight:400}.sent-eng[_ngcontent-%COMP%]{font-size:24px;font-weight:300}"],data:{animation:[da,ua,ha,fa]}});let n=e;return n})();var ri=(()=>{let e=class e{constructor(){this.undos=[],this.redos=[],this.activeUndo=new z,this.activeRedo=new z}pushUndo(i){this.undos.push(i)}pushRedo(i){this.redos.push(i)}applyUndo(){let i=this.undos.pop();i&&(this.redos.push(i),this.activeUndo.next(i))}applyRedo(){let i=this.redos.pop();i&&(this.undos.push(i),this.activeRedo.next(i))}reset(){this.resetUndos(),this.resetRedos()}resetUndos(){this.undos=[]}resetRedos(){this.redos=[]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Y({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var Id=n=>({width:n});function Od(n,e){n&1&&m(0,"app-loading")}function Nd(n,e){if(n&1){let t=F();d(0,"app-card",25),A(1,"typeColor"),y("onSwiped",function(r){x(t);let s=_(4);return b(s.handleSwiped(r))})("onUpdated",function(r){x(t);let s=_(4);return b(s.handleCardUpdated(r))})("onDeleted",function(r){x(t);let s=_(4);return b(s.handleCardDeleted(r))}),p()}if(n&2){let t=_().$implicit,i=_(3);v("card",t)("color",D(1,3,t.type))("baseFront",i.getbaseFront())}}function Rd(n,e){if(n&1&&(Gr(0),I(1,Nd,2,5,"app-card",24),Br()),n&2){let t=e.index,i=_(3);C(),v("ngIf",t===i.deck.length-1)}}function Fd(n,e){if(n&1&&(d(0,"div",0),I(1,Rd,2,1,"ng-container",21),d(2,"div",22),m(3,"div",23),p()()),n&2){let t=_(2);C(),v("ngForOf",t.deck),C(2),le(ie(3,Id,t.deckProgress))}}function Ad(n,e){if(n&1){let t=F();d(0,"div",28)(1,"p"),T(2,"You're out of cards!"),p(),d(3,"button",29),y("click",function(){x(t);let r=_(3);return b(r.initAndDeal())}),T(4,"Reset card pile?"),p()()}}function Dd(n,e){if(n&1){let t=F();d(0,"button",29),y("click",function(){x(t);let r=_(3);return b(r.dealMissed())}),T(1),p()}if(n&2){let t=_(3);C(),oe("Deal ",t.missed.length," missed cards?")}}function Ld(n,e){if(n&1){let t=F();d(0,"button",29),y("click",function(){x(t);let r=_(3);return b(r.dealSameDeck())}),T(1,"Deal same deck?"),p()}}function Vd(n,e){if(n&1){let t=F();d(0,"button",29),y("click",function(){x(t);let r=_(3);return b(r.dealNewDeck())}),T(1),p()}if(n&2){let t=_(3);C(),oe("Deal another ",t.getDeckSize(),"?")}}function jd(n,e){if(n&1&&(d(0,"div",1),I(1,Ad,5,0,"div",26)(2,Dd,2,1,"button",27)(3,Ld,2,0,"button",27)(4,Vd,2,1,"button",27),p()),n&2){let t=_(2);C(),v("ngIf",t.pile.length===0),C(),v("ngIf",t.missed.length>0),C(),v("ngIf",t.currentDeck.length>0),C(),v("ngIf",t.pile.length>0)}}function Gd(n,e){if(n&1){let t=F();I(0,Fd,4,5,"div",0)(1,jd,5,4,"div",1),d(2,"app-navbar")(3,"button",2),y("click",function(){x(t);let r=_();return b(r.backPressed())}),P(),d(4,"svg",3),m(5,"g",4)(6,"g",5),d(7,"g",6),m(8,"path",7),p()()(),ee(),d(9,"button",8),y("click",function(){x(t);let r=_();return b(r.undoPressed())}),P(),d(10,"svg",9),m(11,"g",4)(12,"g",10),d(13,"g",6)(14,"title"),T(15,"undo"),p(),d(16,"g",11)(17,"g",12),m(18,"rect",13),p(),d(19,"g",14),m(20,"path",15),p()()()()(),ee(),d(21,"button",16),y("click",function(){x(t);let r=_();return b(r.addPressed())}),P(),d(22,"svg",17),m(23,"g",4)(24,"g",10),d(25,"g",6),m(26,"path",18)(27,"path",19),p()()(),ee(),d(28,"button",20),y("click",function(){x(t);let r=_();return b(r.redoPressed())}),P(),d(29,"svg",9),m(30,"g",4)(31,"g",10),d(32,"g",6)(33,"title"),T(34,"undo"),p(),d(35,"g",11)(36,"g",12),m(37,"rect",13),p(),d(38,"g",14),m(39,"path",15),p()()()()()()}if(n&2){let t=_();ne(t.deck.length>0?0:1)}}var Vr=(()=>{let e=class e{constructor(i,r,s,o,a,l,c,u){this.actionsService=i,this.route=r,this.cardService=s,this.menuService=o,this.notificationService=a,this.router=l,this.setsService=c,this.settingsService=u,this.loading=!1,this.subs=[],this.set=null,this.pile=[],this.deck=[],this.currentDeck=[],this.missed=[],this.deckProgress="0%"}ngOnInit(){this.loading=!0,this.settingsService.loading?this.settingsService.loaded.subscribe(()=>this.init()):this.init()}init(){return M(this,null,function*(){this.subs=[this.route.paramMap.subscribe(i=>this.loadCards(i)),this.actionsService.activeUndo.subscribe(i=>this.applyUndo(i)),this.actionsService.activeRedo.subscribe(i=>this.applyRedo(i)),this.settingsService.dealStarredChanged.subscribe(()=>this.initAndDeal()),this.cardService.cardAdded.subscribe(i=>{this.pile.push(i)})]})}loadCards(i){return M(this,null,function*(){this.set=yield this.setsService.loadSetFromParams(i),this.cardService.loadCards().then(()=>{this.initAndDeal(),this.loading=!1}).catch(()=>{this.notificationService.push({message:"Couldn't load cards!",success:!1})})})}initPile(){return M(this,null,function*(){if(this.set){this.pile=yield this.setsService.getCards(this.set.id);return}this.settingsService.getDealStarred()?this.pile=structuredClone(this.cardService.getStarred()):this.pile=structuredClone(this.cardService.getCards())})}initAndDeal(){this.initPile().then(()=>this.dealNewDeck())}applyUndo(i){i.direction||this.missed.splice(this.missed.findIndex(r=>r.id===i.card.id),1),this.deck.push(i.card),this.setDeckProgress()}applyRedo(i){this.handleSwiped(i.direction)}refreshWorkingCards(){let i=this.cardService.getCards();for(let r of[this.currentDeck,this.deck,this.missed])for(let s=0;s<r.length;s++){let o=this.cardService.findCardIndex(r[s].id);if(o===null)return;r[s]=i[o]}}removeFromWorkingCards(i){for(let r of[this.currentDeck,this.deck,this.missed])for(let s=0;s<r.length;s++)if(r[s].id===i){r.splice(s,1);break}}updateCard(i){let r=this.cardService.findCardIndex(i.id);r!==null&&this.cardService.update(i,r).then(()=>{this.notificationService.push({message:"Card updated!",success:!0}),this.refreshWorkingCards()}).catch(s=>{this.notificationService.push({message:"Card update failed! "+s,success:!1})})}deleteCard(i){let r=this.cardService.findCardIndex(i);r!==null&&this.cardService.delete(i,r).then(()=>{this.notificationService.push({message:"Card deleted!",success:!0}),this.actionsService.reset(),this.removeFromWorkingCards(i)}).catch(s=>{this.notificationService.push({message:"Failed to delete card! "+s,success:!1})})}getbaseFront(){return this.settingsService.getBaseFront()}getDeckSize(){return this.settingsService.getDeckSize()}shuffle(i){for(let r=i.length-1;r>0;r--){let s=Math.floor(Math.random()*(r+1));[i[r],i[s]]=[i[s],i[r]]}}deal(i){let r=[];for(let s=0;s<this.getDeckSize();s++){if(i.length===0)return r;let o=Math.floor(Math.random()*i.length);r.push(i[o]),i.splice(o,1)}return r}initDeck(){this.missed=[],this.actionsService.reset(),this.setDeckProgress()}dealMissed(){this.deck=this.missed,this.shuffle(this.deck),this.initDeck()}dealSameDeck(){this.deck=structuredClone(this.currentDeck),this.shuffle(this.deck),this.initDeck()}dealNewDeck(){this.deck=this.deal(this.pile),this.currentDeck=structuredClone(this.deck),this.initDeck()}handleSwiped(i){let r=this.deck.pop();r&&(this.actionsService.pushUndo({direction:i,card:r}),this.actionsService.resetRedos(),i||this.missed.push(r),this.setDeckProgress())}setDeckProgress(){let i=this.currentDeck.length;this.deckProgress=100*((1+Math.abs(this.deck.length-i))/i)+"%"}handleCardUpdated(i){this.updateCard(i)}handleCardDeleted(i){this.deleteCard(i.id)}backPressed(){this.router.navigateByUrl("")}undoPressed(){this.actionsService.applyUndo()}addPressed(){this.menuService.openAddCard()}redoPressed(){this.actionsService.applyRedo()}ngOnDestroy(){this.subs.forEach(i=>i.unsubscribe())}};e.\u0275fac=function(r){return new(r||e)(k(ri),k(gn),k(Oe),k(Ne),k(ce),k(Le),k(xe),k(At))},e.\u0275cmp=V({type:e,selectors:[["app-deck"]],standalone:!0,features:[j],decls:2,vars:1,consts:[[1,"deck"],[1,"options"],["title","Home",1,"icon-btn",3,"click"],["fill","#000000","viewBox","0 0 24 24","id","Layer_1","data-name","Layer 1","xmlns","http://www.w3.org/2000/svg","transform","matrix(1, 0, 0, 1, 0, 0)"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round","stroke","#CCCCCC","stroke-width","0.24000000000000005"],["id","SVGRepo_iconCarrier"],["d","M20.466,1.967,14.78.221a5.011,5.011,0,0,0-6.224,3.24L8.368,4H5A5.006,5.006,0,0,0,0,9V19a5.006,5.006,0,0,0,5,5h6a4.975,4.975,0,0,0,3.92-1.934,5.029,5.029,0,0,0,.689.052,4.976,4.976,0,0,0,4.775-3.563L23.8,8.156A5.021,5.021,0,0,0,20.466,1.967ZM11,22H5a3,3,0,0,1-3-3V9A3,3,0,0,1,5,6h6a3,3,0,0,1,3,3V19A3,3,0,0,1,11,22ZM21.887,7.563l-3.412,10.4a2.992,2.992,0,0,1-2.6,2.134A4.992,4.992,0,0,0,16,19V9a5.006,5.006,0,0,0-5-5h-.507a3,3,0,0,1,3.7-1.867l5.686,1.746A3.006,3.006,0,0,1,21.887,7.563ZM12,13c0,1.45-1.544,3.391-2.714,4.378a1.991,1.991,0,0,1-2.572,0C5.544,16.391,4,14.45,4,13a2,2,0,0,1,4,0,2,2,0,0,1,4,0Z"],["title","Undo",1,"icon-btn",3,"click"],["viewBox","0 0 48 48","xmlns","http://www.w3.org/2000/svg","fill","#000000"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","Layer_2","data-name","Layer 2"],["id","invisible_box","data-name","invisible box"],["width","48","height","48","fill","none"],["id","icons_Q2","data-name","icons Q2"],["d","M46,24A22,22,0,0,1,4.3,33.7a2,2,0,0,1,.5-2.6,2,2,0,0,1,3,.7A17.8,17.8,0,0,0,24,42,18,18,0,1,0,10.6,12h5.3A2.1,2.1,0,0,1,18,13.7,2,2,0,0,1,16,16H6a2,2,0,0,1-2-2V4.1A2.1,2.1,0,0,1,5.7,2,2,2,0,0,1,8,4V8.9A22,22,0,0,1,46,24Z"],["title","Add",1,"icon-btn",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M11 8C11 7.44772 11.4477 7 12 7C12.5523 7 13 7.44772 13 8V11H16C16.5523 11 17 11.4477 17 12C17 12.5523 16.5523 13 16 13H13V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V13H8C7.44771 13 7 12.5523 7 12C7 11.4477 7.44772 11 8 11H11V8Z","fill","#0F0F0F"],["fill-rule","evenodd","clip-rule","evenodd","d","M23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12ZM3.00683 12C3.00683 16.9668 7.03321 20.9932 12 20.9932C16.9668 20.9932 20.9932 16.9668 20.9932 12C20.9932 7.03321 16.9668 3.00683 12 3.00683C7.03321 3.00683 3.00683 7.03321 3.00683 12Z","fill","#0F0F0F"],["title","Redo",1,"icon-btn",2,"transform","rotateY(180deg)",3,"click"],[4,"ngFor","ngForOf"],[1,"progress"],[1,"progress-inner"],[3,"card","color","baseFront","onSwiped","onUpdated","onDeleted",4,"ngIf"],[3,"onSwiped","onUpdated","onDeleted","card","color","baseFront"],["style","text-align: center;",4,"ngIf"],["class","btn",3,"click",4,"ngIf"],[2,"text-align","center"],[1,"btn",3,"click"]],template:function(r,s){r&1&&I(0,Od,1,0,"app-loading")(1,Gd,40,1,"app-navbar"),r&2&&ne(s.loading?0:1)},dependencies:[X,Z,pe,Dt,$e,ii,Ke],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}[_nghost-%COMP%]{display:flex;flex-direction:column;margin:auto;width:100%;height:100%}.deck[_ngcontent-%COMP%]{height:100%;padding:1rem}.progress[_ngcontent-%COMP%]{width:100%;height:.25rem;background:#789;margin-top:.25rem;border-radius:2px}.progress-inner[_ngcontent-%COMP%]{height:100%;border-radius:2px;background:#7fffd4}.options[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:auto;gap:2rem}"]});let n=e;return n})();var Bd=n=>({background:n});function Hd(n,e){n&1&&m(0,"app-loading")}function Ud(n,e){if(n&1){let t=F();d(0,"div",0)(1,"app-card",6),A(2,"typeColor"),y("onSwiped",function(){x(t);let r=_(2);return b(r.handleBack())})("onUpdated",function(r){x(t);let s=_(2);return b(s.handleUpdateCard(r))})("onDeleted",function(r){x(t);let s=_(2);return b(s.handleCardDeleted(r))}),p()()}if(n&2){let t=_(2);C(),v("card",t.expandedCard)("color",D(2,3,t.expandedCard.type))("baseFront",t.getBaseFront())}}function Wd(n,e){n&1&&(P(),d(0,"svg",12),m(1,"g",14)(2,"g",15),d(3,"g",16),m(4,"path",17),p()())}function zd(n,e){n&1&&(P(),d(0,"svg",13),m(1,"g",14)(2,"g",15),d(3,"g",16),m(4,"path",18),p()())}function qd(n,e){if(n&1){let t=F();d(0,"div",8),A(1,"typeColor"),y("click",function(){let r=x(t).$implicit,s=_(3);return b(s.expandCard(r))}),d(2,"div",9)(3,"div",10),T(4),p(),d(5,"button",11),y("click",function(r){let s=x(t).$implicit,o=_(3);return b(o.openSetSelect(r,s))}),I(6,Wd,5,0,":svg:svg",12)(7,zd,5,0,":svg:svg",13),p()()()}if(n&2){let t=e.$implicit,i=_(3);le(ie(6,Bd,D(1,4,t.type))),C(4),oe(" ",i.getBaseFront()?t.base:t.goal," "),C(2),ne(t.starred?6:7)}}function Yd(n,e){if(n&1&&(d(0,"div",1),I(1,qd,8,8,"div",7),p()),n&2){let t=_(2);C(),v("ngForOf",t.results.slice(0,t.maxCards))}}function Kd(n,e){if(n&1){let t=F();d(0,"button",19),y("click",function(){x(t);let r=_(2);return b(r.backPressed())}),P(),d(1,"svg",20),m(2,"g",14)(3,"g",15),d(4,"g",16),m(5,"path",21),p()()()}}function $d(n,e){if(n&1){let t=F();d(0,"button",22),y("click",function(){x(t);let r=_(2);return b(r.backPressed())}),P(),d(1,"svg",23),m(2,"g",14)(3,"g",24),d(4,"g",16),m(5,"path",25),p()()()}}function Qd(n,e){if(n&1&&(I(0,Ud,3,5,"div",0)(1,Yd,2,1,"div",1),d(2,"app-navbar"),I(3,Kd,6,0,"button",2)(4,$d,6,0,"button",3),d(5,"div",4),m(6,"input",5),p()()),n&2){let t=_();ne(t.expandedCard&&t.expanded?0:1),C(3),ne(t.expanded&&t.expandedCard?3:4),C(3),v("formControl",t.query)}}var jr=(()=>{let e=class e{constructor(i,r,s,o,a,l,c){this.route=i,this.cardService=r,this.notificationService=s,this.router=o,this.setsService=a,this.settingsService=l,this.setSelectService=c,this.loading=!1,this.subs=[],this.maxCards=100,this.set=null,this.results=[],this.expanded=!1,this.expandedCard=null,this.query=new W("")}ngOnInit(){this.loading=!0,this.settingsService.loading?this.settingsService.loaded.subscribe(()=>this.init()):this.init()}init(){return M(this,null,function*(){yield this.cardService.loadCards().then(i=>{this.results=i,this.loading=!1}).catch(i=>alert("Failed to get cards from database! "+i)),this.subs=[this.route.paramMap.subscribe(i=>this.loadSet(i)),this.setsService.updated.subscribe(()=>{this.refreshSet()}),this.query.valueChanges.subscribe(i=>{this.set?this.filterSet(i):this.filterAll(i)})]})}loadSet(i){return M(this,null,function*(){this.set=yield this.setsService.loadSetFromParams(i),this.set&&(this.results=yield this.setsService.getCards(this.set.id)),this.loading=!1})}refreshSet(){return M(this,null,function*(){this.set&&(this.set&&(this.results=yield this.setsService.getCards(this.set.id)),this.filterSet(this.query.value))})}getBaseFront(){return this.settingsService.getBaseFront()}filterSet(i){return M(this,null,function*(){if(this.set===null)return;if(!i){this.results=yield this.setsService.getCards(this.set.id);return}let r=yield this.setsService.getCards(this.set.id);this.results=r.filter(s=>s.base.toLowerCase().includes(i.toLowerCase())||s.goal.toLowerCase().includes(i.toLowerCase()))})}filterAll(i){if(!i){this.results=this.cardService.getCards();return}this.results=this.cardService.getCards().filter(r=>r.base.toLowerCase().includes(i.toLowerCase())||r.goal.toLowerCase().includes(i.toLowerCase()))}openSetSelect(i,r){i.stopPropagation(),this.setSelectService.open(r.id)}expandCard(i){this.expanded=!0,this.expandedCard=i}updateResults(i){this.results.forEach((r,s)=>{if(r.id===i.id){this.results[s]=i;return}})}updateCard(i){let r=this.cardService.findCardIndex(i.id);r!==null&&this.cardService.update(i,r).then(()=>{this.updateResults(i),this.expandCard(i),this.notificationService.push({message:"Card updated!",success:!0})}).catch(s=>{this.notificationService.push({message:"Card update failed! "+s,success:!1})})}deleteCard(i){let r=this.cardService.findCardIndex(i);r!==null&&this.cardService.delete(i,r).then(()=>{this.notificationService.push({message:"Card deleted!",success:!0})}).catch(s=>{this.notificationService.push({message:"Failed to delete card! "+s,success:!1})})}backPressed(){if(!this.expanded&&this.expandedCard===null){this.router.navigateByUrl("");return}this.handleBack()}handleBack(){this.expanded=!1,this.expandedCard=null}handleUpdateCard(i){this.updateCard(i)}handleCardDeleted(i){this.deleteCard(i.id),this.handleBack()}ngOnDestroy(){this.subs.forEach(i=>i.unsubscribe())}};e.\u0275fac=function(r){return new(r||e)(k(gn),k(Oe),k(ce),k(Le),k(xe),k(At),k(Ft))},e.\u0275cmp=V({type:e,selectors:[["app-list"]],standalone:!0,features:[j],decls:2,vars:1,consts:[[1,"wrapper"],[1,"list"],["title","Back",1,"icon-btn"],["title","Home",1,"icon-btn"],[1,"search-container"],["type","text","placeholder","search...",1,"search",3,"formControl"],[2,"height","100%",3,"onSwiped","onUpdated","onDeleted","card","color","baseFront"],["class","list-card",3,"style","click",4,"ngFor","ngForOf"],[1,"list-card",3,"click"],[1,"row-between"],[1,"col-center",2,"max-width","75%"],[1,"icon-btn",2,"width","3rem","height","3rem",3,"click"],["fill","#ffff00","viewBox","0 0 1920 1920","xmlns","http://www.w3.org/2000/svg","stroke","#ffff00"],["fill","#000000","viewBox","0 0 1920 1920","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M1915.918 737.475c-10.955-33.543-42.014-56.131-77.364-56.131h-612.029l-189.063-582.1v-.112C1026.394 65.588 995.335 43 959.984 43c-35.237 0-66.41 22.588-77.365 56.245L693.443 681.344H81.415c-35.35 0-66.41 22.588-77.365 56.131-10.955 33.544.79 70.137 29.478 91.03l495.247 359.831-189.177 582.212c-10.955 33.657 1.13 70.25 29.817 90.918 14.23 10.278 30.946 15.487 47.66 15.487 16.716 0 33.432-5.21 47.775-15.6l495.134-359.718 495.021 359.718c28.574 20.781 67.087 20.781 95.662.113 28.687-20.668 40.658-57.261 29.703-91.03l-189.176-582.1 495.36-359.83c28.574-20.894 40.433-57.487 29.364-91.03","fill-rule","evenodd"],["d","M1306.181 1110.407c-28.461 20.781-40.32 57.261-29.477 91.03l166.136 511.398-435.05-316.122c-28.686-20.781-67.086-20.781-95.66 0l-435.05 316.122 166.25-511.623c10.842-33.544-1.017-70.024-29.591-90.805L178.577 794.285h537.825c35.351 0 66.523-22.701 77.365-56.245l166.25-511.51 166.136 511.397a81.155 81.155 0 0 0 77.365 56.358h537.939l-435.276 316.122Zm609.77-372.819c-10.956-33.656-42.014-56.244-77.365-56.244h-612.141l-189.064-582.1C1026.426 65.589 995.367 43 960.017 43c-35.351 0-66.523 22.588-77.365 56.245L693.475 681.344H81.335c-35.351 0-66.41 22.588-77.366 56.244-10.842 33.657 1.017 70.137 29.591 90.918l495.247 359.718-189.29 582.211c-10.842 33.657 1.017 70.137 29.704 90.918 14.23 10.39 31.059 15.586 47.661 15.586 16.829 0 33.657-5.195 47.887-15.699l495.248-359.718 495.02 359.718c28.575 20.894 67.088 20.894 95.775.113 28.574-20.781 40.433-57.261 29.59-91.03l-189.289-582.1 495.247-359.717c28.687-20.781 40.546-57.261 29.59-90.918Z","fill-rule","evenodd"],["title","Back",1,"icon-btn",3,"click"],["fill","#000000","viewBox","0 0 1024 1024","xmlns","http://www.w3.org/2000/svg"],["d","M222.927 580.115l301.354 328.512c24.354 28.708 20.825 71.724-7.883 96.078s-71.724 20.825-96.078-7.883L19.576 559.963a67.846 67.846 0 01-13.784-20.022 68.03 68.03 0 01-5.977-29.488l.001-.063a68.343 68.343 0 017.265-29.134 68.28 68.28 0 011.384-2.6 67.59 67.59 0 0110.102-13.687L429.966 21.113c25.592-27.611 68.721-29.247 96.331-3.656s29.247 68.721 3.656 96.331L224.088 443.784h730.46c37.647 0 68.166 30.519 68.166 68.166s-30.519 68.166-68.166 68.166H222.927z"],["title","Home",1,"icon-btn",3,"click"],["fill","#000000","viewBox","0 0 24 24","id","Layer_1","data-name","Layer 1","xmlns","http://www.w3.org/2000/svg","transform","matrix(1, 0, 0, 1, 0, 0)"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round","stroke","#CCCCCC","stroke-width","0.24000000000000005"],["d","M20.466,1.967,14.78.221a5.011,5.011,0,0,0-6.224,3.24L8.368,4H5A5.006,5.006,0,0,0,0,9V19a5.006,5.006,0,0,0,5,5h6a4.975,4.975,0,0,0,3.92-1.934,5.029,5.029,0,0,0,.689.052,4.976,4.976,0,0,0,4.775-3.563L23.8,8.156A5.021,5.021,0,0,0,20.466,1.967ZM11,22H5a3,3,0,0,1-3-3V9A3,3,0,0,1,5,6h6a3,3,0,0,1,3,3V19A3,3,0,0,1,11,22ZM21.887,7.563l-3.412,10.4a2.992,2.992,0,0,1-2.6,2.134A4.992,4.992,0,0,0,16,19V9a5.006,5.006,0,0,0-5-5h-.507a3,3,0,0,1,3.7-1.867l5.686,1.746A3.006,3.006,0,0,1,21.887,7.563ZM12,13c0,1.45-1.544,3.391-2.714,4.378a1.991,1.991,0,0,1-2.572,0C5.544,16.391,4,14.45,4,13a2,2,0,0,1,4,0,2,2,0,0,1,4,0Z"]],template:function(r,s){r&1&&I(0,Hd,1,0,"app-loading")(1,Qd,7,3,"app-navbar"),r&2&&ne(s.loading?0:1)},dependencies:[X,Z,Be,Ve,je,us,Dt,$e,ii,Ke],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}[_nghost-%COMP%]{display:flex;flex-direction:column;margin:auto;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{height:100%;margin:1rem}.search-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.search[_ngcontent-%COMP%]{border:4px solid black;border-radius:10px;background:none;outline:none;box-shadow:none}"]});let n=e;return n})();var ma=(()=>{let e=class e{constructor(i){this.actionsService=i,this.listOpen=!1,this.listExpanded=!1,this.query=new z}ngOnInit(){}toggleList(){this.listOpen=!this.listOpen}handleBack(){this.listExpanded?this.listExpanded=!1:this.listOpen=!1}handleUndo(){this.actionsService.applyUndo()}handleRedo(){this.actionsService.applyRedo()}handleSearch(i){this.query.next(i)}};e.\u0275fac=function(r){return new(r||e)(k(ri))},e.\u0275cmp=V({type:e,selectors:[["app-layout"]],standalone:!0,features:[j],decls:5,vars:0,consts:[[1,"content"]],template:function(r,s){r&1&&(d(0,"div",0),m(1,"app-notifications")(2,"app-set-select")(3,"app-menu")(4,"router-outlet"),p())},dependencies:[Wr,hs,sa,ca],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.content[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;display:flex;flex-direction:column;justify-content:space-between}"]});let n=e;return n})();var Zd=n=>({background:n});function Xd(n,e){if(n&1&&(d(0,"a",14),T(1),p()),n&2){let t=e.$implicit;le(ie(4,Zd,t.color)),v("routerLink",t.link),C(),fe(t.link)}}var _a=(()=>{let e=class e{constructor(i,r){this.authService=i,this.menuService=r,this.menuOptions=[{link:"list",color:"lightgreen"},{link:"deck",color:"plum"},{link:"sets",color:"palegoldenrod"}]}logout(){this.authService.signOut(),window.location.reload()}addPressed(){this.menuService.openAddCard()}};e.\u0275fac=function(r){return new(r||e)(k(me),k(Ne))},e.\u0275cmp=V({type:e,selectors:[["app-landing"]],standalone:!0,features:[j],decls:18,vars:1,consts:[[1,"wrapper"],["class","menu-card",3,"routerLink","style",4,"ngFor","ngForOf"],["title","Logout",1,"icon-btn",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg","transform","rotate(180)"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M21 12L13 12","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M18 15L20.913 12.087V12.087C20.961 12.039 20.961 11.961 20.913 11.913V11.913L18 9","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M16 5V4.5V4.5C16 3.67157 15.3284 3 14.5 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H14.5C15.3284 21 16 20.3284 16 19.5V19.5V19","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["title","Add",1,"icon-btn",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M11 8C11 7.44772 11.4477 7 12 7C12.5523 7 13 7.44772 13 8V11H16C16.5523 11 17 11.4477 17 12C17 12.5523 16.5523 13 16 13H13V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V13H8C7.44771 13 7 12.5523 7 12C7 11.4477 7.44772 11 8 11H11V8Z","fill","#0F0F0F"],["fill-rule","evenodd","clip-rule","evenodd","d","M23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12ZM3.00683 12C3.00683 16.9668 7.03321 20.9932 12 20.9932C16.9668 20.9932 20.9932 16.9668 20.9932 12C20.9932 7.03321 16.9668 3.00683 12 3.00683C7.03321 3.00683 3.00683 7.03321 3.00683 12Z","fill","#0F0F0F"],[1,"menu-card",3,"routerLink"]],template:function(r,s){r&1&&(d(0,"div",0),I(1,Xd,2,6,"a",1),p(),d(2,"app-navbar")(3,"button",2),y("click",function(){return s.logout()}),P(),d(4,"svg",3),m(5,"g",4)(6,"g",5),d(7,"g",6),m(8,"path",7)(9,"path",8)(10,"path",9),p()()(),ee(),d(11,"button",10),y("click",function(){return s.addPressed()}),P(),d(12,"svg",11),m(13,"g",4)(14,"g",5),d(15,"g",6),m(16,"path",12)(17,"path",13),p()()()()),r&2&&(C(),v("ngForOf",s.menuOptions))},dependencies:[X,Z,zr,$e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;margin:auto;width:100%;height:100%}.wrapper[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;margin:1rem;gap:.5rem}.menu-card[_ngcontent-%COMP%]{width:100%;height:100%;text-align:center;display:flex;flex-direction:column;justify-content:center;border-radius:10px;box-shadow:0 1px 2px gray;text-decoration:none;color:#000;font-size:28px}"]});let n=e;return n})();function Jd(n,e){if(n&1){let t=F();d(0,"app-color-choice",8),y("click",function(){let r=x(t).$implicit,s=_(2);return b(s.setForm.patchValue({color:r}))}),p()}if(n&2){let t,i=e.$implicit,r=_(2);v("value",i)("selected",((t=r.setForm.get("color"))==null?null:t.value)===i)}}function eu(n,e){if(n&1){let t=F();d(0,"button",9),y("click",function(){x(t);let r=_(3);return b(r.update())}),P(),d(1,"svg",10),m(2,"g",11)(3,"g",12),d(4,"g",13),m(5,"path",19),p()()()}}function tu(n,e){if(n&1){let t=F();d(0,"button",9),y("click",function(){x(t);let r=_(2);return b(r.close())}),P(),d(1,"svg",10),m(2,"g",11)(3,"g",12),d(4,"g",13)(5,"g",14),m(6,"path",15),p()()()(),I(7,eu,6,0,"button",16),ee(),d(8,"button",9),y("click",function(){x(t);let r=_(2);return b(r.confirmOpen=!0)}),P(),d(9,"svg",17),m(10,"g",11)(11,"g",12),d(12,"g",13),m(13,"path",18),p()()()}if(n&2){let t=_(2);C(7),v("ngIf",t.setForm.valid)}}function nu(n,e){if(n&1){let t=F();d(0,"div",7)(1,"button",20),y("click",function(){x(t);let r=_(2);return b(r.delete())}),T(2,"yes"),p(),d(3,"div",21),T(4,"Delete set?"),p(),d(5,"button",22),y("click",function(){x(t);let r=_(2);return b(r.confirmOpen=!1)}),T(6,"no"),p()()}}function iu(n,e){if(n&1){let t=F();d(0,"app-modal",1),y("close",function(){x(t);let r=_();return b(r.close())}),d(1,"h3"),T(2),p(),d(3,"form",2),m(4,"input",3),d(5,"div",4),I(6,Jd,1,2,"app-color-choice",5),p()(),d(7,"div",6),I(8,tu,14,1)(9,nu,7,0,"div",7),p()()}if(n&2){let t=_();C(2),oe("Edit ",t.set.name,""),C(),v("formGroup",t.setForm),C(3),v("ngForOf",t.getColorOptions()),C(2),ne(t.confirmOpen?9:8)}}var ga=(()=>{let e=class e{constructor(i){this.setsService=i,this.subs=[],this.confirmOpen=!1,this.set=null,this.setForm=new Ge({name:new W(null,re.required),color:new W(null,re.required)})}ngOnInit(){this.subs=[this.editing.subscribe(i=>this.initEditing(i))]}initEditing(i){this.set=i,this.setForm.patchValue({name:this.set?.name,color:this.set?.color})}getColorOptions(){return this.setsService.colorOptions}update(){if(!this.set)return;let i=this.setForm.value;this.setsService.updateSet(ct(Re({},this.set),{name:i.name?i.name:"",color:i.color?i.color:"lightgray"})).then(()=>this.close())}delete(){this.set&&this.setsService.deleteSet(this.set.id).then(()=>this.close())}close(){this.confirmOpen=!1,this.set=null,this.setForm.reset()}ngOnDestroy(){this.subs.forEach(i=>i.unsubscribe())}};e.\u0275fac=function(r){return new(r||e)(k(xe))},e.\u0275cmp=V({type:e,selectors:[["app-set-edit"]],inputs:{editing:"editing"},standalone:!0,features:[j],decls:1,vars:1,consts:[["class","container",3,"close",4,"ngIf"],[1,"container",3,"close"],[1,"add-form",3,"formGroup"],["type","text","formControlName","name","placeholder","Name",1,"border-input"],[1,"color-container"],[3,"value","selected","click",4,"ngFor","ngForOf"],[1,"row-between",2,"margin-top","1rem"],[1,"confirm-row"],[3,"click","value","selected"],[1,"icon-btn",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["id","Menu / Close_LG"],["id","Vector","d","M21 21L12 12M12 12L3 3M12 12L21.0001 3M12 12L3 21.0001","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["class","icon-btn",3,"click",4,"ngIf"],["viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg","fill","none"],["fill","#000000","fill-rule","evenodd","d","M7 1a2 2 0 00-2 2v2H2a1 1 0 000 2h.884c.036.338.078.754.12 1.213.11 1.202.218 2.664.218 3.787 0 1.47-.183 3.508-.315 4.776a2.015 2.015 0 002 2.224h10.186a2.015 2.015 0 002-2.224c-.132-1.268-.315-3.306-.315-4.776 0-1.123.107-2.585.218-3.787.042-.459.084-.875.12-1.213H18a1 1 0 100-2h-3V3a2 2 0 00-2-2H7zm6 4V3H7v2h6zM4.996 8.03c-.035-.378-.07-.728-.101-1.03h10.21a81.66 81.66 0 00-.1 1.03c-.112 1.212-.227 2.75-.227 3.97 0 1.584.194 3.714.325 4.982v.007a.02.02 0 01-.005.008l-.003.003H4.905a.024.024 0 01-.008-.01v-.008c.131-1.268.325-3.398.325-4.982 0-1.22-.115-2.758-.226-3.97zM8 8a1 1 0 011 1v6a1 1 0 11-2 0V9a1 1 0 011-1zm5 1a1 1 0 10-2 0v6a1 1 0 102 0V9z"],["fill-rule","evenodd","clip-rule","evenodd","d","M18.1716 1C18.702 1 19.2107 1.21071 19.5858 1.58579L22.4142 4.41421C22.7893 4.78929 23 5.29799 23 5.82843V20C23 21.6569 21.6569 23 20 23H4C2.34315 23 1 21.6569 1 20V4C1 2.34315 2.34315 1 4 1H18.1716ZM4 3C3.44772 3 3 3.44772 3 4V20C3 20.5523 3.44772 21 4 21L5 21L5 15C5 13.3431 6.34315 12 8 12L16 12C17.6569 12 19 13.3431 19 15V21H20C20.5523 21 21 20.5523 21 20V6.82843C21 6.29799 20.7893 5.78929 20.4142 5.41421L18.5858 3.58579C18.2107 3.21071 17.702 3 17.1716 3H17V5C17 6.65685 15.6569 8 14 8H10C8.34315 8 7 6.65685 7 5V3H4ZM17 21V15C17 14.4477 16.5523 14 16 14L8 14C7.44772 14 7 14.4477 7 15L7 21L17 21ZM9 3H15V5C15 5.55228 14.5523 6 14 6H10C9.44772 6 9 5.55228 9 5V3Z","fill","#0F0F0F"],[1,"btn","submit",3,"click"],[1,"col-center"],[1,"btn","cancel",3,"click"]],template:function(r,s){r&1&&I(0,iu,10,4,"app-modal",0),r&2&&v("ngIf",s.set)},dependencies:[X,Z,pe,Be,pt,Ve,je,ft,mt,_t,gt,ti],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}.btn[_ngcontent-%COMP%]{margin:0}.confirm-row[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row;justify-content:space-between;margin-bottom:1rem}"]});let n=e;return n})();var ru=n=>({backgroundColor:n});function su(n,e){n&1&&m(0,"app-loading")}function ou(n,e){if(n&1&&m(0,"app-set-edit",14),n&2){let t=_(2);v("editing",t.editing)}}function au(n,e){if(n&1){let t=F();d(0,"div",15)(1,"div",16),y("click",function(){let r=x(t).$implicit,s=_(2);return b(s.navigateToList(r))}),d(2,"div",17),T(3),p(),d(4,"div",18)(5,"button",19),y("click",function(r){let s=x(t).$implicit,o=_(2);return b(o.edit(r,s))}),P(),d(6,"svg",10),m(7,"g",5)(8,"g",11),d(9,"g",7)(10,"g",20)(11,"g",21),m(12,"path",22)(13,"path",23),p()()()()(),ee(),d(14,"div",24),T(15),p(),d(16,"button",19),y("click",function(){let r=x(t).$implicit,s=_(2);return b(s.navigateToDeck(r))}),P(),d(17,"svg",10),m(18,"g",5)(19,"g",11),d(20,"g",7),m(21,"path",25),p()()()()()()}if(n&2){let t=e.$implicit;C(),le(ie(5,ru,t.color)),C(2),oe(" ",t.name," "),C(12),Hr(" ",t.cards.length," card",t.cards.length===1?"":"s"," ")}}function lu(n,e){if(n&1){let t=F();I(0,ou,1,1,"app-set-edit",0),d(1,"div",1),I(2,au,22,7,"div",2),p(),d(3,"app-navbar")(4,"button",3),y("click",function(){x(t);let r=_();return b(r.backPressed())}),P(),d(5,"svg",4),m(6,"g",5)(7,"g",6),d(8,"g",7),m(9,"path",8),p()()(),ee(),d(10,"button",9),y("click",function(){x(t);let r=_();return b(r.addPressed())}),P(),d(11,"svg",10),m(12,"g",5)(13,"g",11),d(14,"g",7),m(15,"path",12)(16,"path",13),p()()()()}if(n&2){let t=_();v("ngIf",t.editing),C(2),v("ngForOf",t.sets)}}var Ca=(()=>{let e=class e{constructor(i,r,s){this.menuService=i,this.router=r,this.setsService=s,this.loading=!1,this.sets=[],this.editing=new z}ngOnInit(){this.loading=!0,this.setsService.loadSets().then(i=>{this.sets=i,this.loading=!1})}navigateToList(i){this.router.navigateByUrl("/list/set/"+i.id)}navigateToDeck(i){this.router.navigateByUrl("/deck/set/"+i.id)}edit(i,r){i.stopPropagation(),this.editing.next(r)}backPressed(){this.router.navigateByUrl("")}addPressed(){this.menuService.openAddSet()}};e.\u0275fac=function(r){return new(r||e)(k(Ne),k(Le),k(xe))},e.\u0275cmp=V({type:e,selectors:[["app-sets"]],standalone:!0,features:[j],decls:2,vars:1,consts:[[3,"editing",4,"ngIf"],[1,"grid"],["class","set",4,"ngFor","ngForOf"],["title","Home",1,"icon-btn",3,"click"],["fill","#000000","viewBox","0 0 24 24","id","Layer_1","data-name","Layer 1","xmlns","http://www.w3.org/2000/svg","transform","matrix(1, 0, 0, 1, 0, 0)"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round","stroke","#CCCCCC","stroke-width","0.24000000000000005"],["id","SVGRepo_iconCarrier"],["d","M20.466,1.967,14.78.221a5.011,5.011,0,0,0-6.224,3.24L8.368,4H5A5.006,5.006,0,0,0,0,9V19a5.006,5.006,0,0,0,5,5h6a4.975,4.975,0,0,0,3.92-1.934,5.029,5.029,0,0,0,.689.052,4.976,4.976,0,0,0,4.775-3.563L23.8,8.156A5.021,5.021,0,0,0,20.466,1.967ZM11,22H5a3,3,0,0,1-3-3V9A3,3,0,0,1,5,6h6a3,3,0,0,1,3,3V19A3,3,0,0,1,11,22ZM21.887,7.563l-3.412,10.4a2.992,2.992,0,0,1-2.6,2.134A4.992,4.992,0,0,0,16,19V9a5.006,5.006,0,0,0-5-5h-.507a3,3,0,0,1,3.7-1.867l5.686,1.746A3.006,3.006,0,0,1,21.887,7.563ZM12,13c0,1.45-1.544,3.391-2.714,4.378a1.991,1.991,0,0,1-2.572,0C5.544,16.391,4,14.45,4,13a2,2,0,0,1,4,0,2,2,0,0,1,4,0Z"],["title","Add",1,"icon-btn",3,"click"],["viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["d","M11 8C11 7.44772 11.4477 7 12 7C12.5523 7 13 7.44772 13 8V11H16C16.5523 11 17 11.4477 17 12C17 12.5523 16.5523 13 16 13H13V16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16V13H8C7.44771 13 7 12.5523 7 12C7 11.4477 7.44772 11 8 11H11V8Z","fill","#0F0F0F"],["fill-rule","evenodd","clip-rule","evenodd","d","M23 12C23 18.0751 18.0751 23 12 23C5.92487 23 1 18.0751 1 12C1 5.92487 5.92487 1 12 1C18.0751 1 23 5.92487 23 12ZM3.00683 12C3.00683 16.9668 7.03321 20.9932 12 20.9932C16.9668 20.9932 20.9932 16.9668 20.9932 12C20.9932 7.03321 16.9668 3.00683 12 3.00683C7.03321 3.00683 3.00683 7.03321 3.00683 12Z","fill","#0F0F0F"],[3,"editing"],[1,"set"],[1,"set-card",3,"click"],[1,"set-title"],[1,"row-between"],[1,"icon-btn",3,"click"],["id","Interface / Settings"],["id","Vector"],["d","M20.3499 8.92293L19.9837 8.7192C19.9269 8.68756 19.8989 8.67169 19.8714 8.65524C19.5983 8.49165 19.3682 8.26564 19.2002 7.99523C19.1833 7.96802 19.1674 7.93949 19.1348 7.8831C19.1023 7.82677 19.0858 7.79823 19.0706 7.76998C18.92 7.48866 18.8385 7.17515 18.8336 6.85606C18.8331 6.82398 18.8332 6.79121 18.8343 6.72604L18.8415 6.30078C18.8529 5.62025 18.8587 5.27894 18.763 4.97262C18.6781 4.70053 18.536 4.44993 18.3462 4.23725C18.1317 3.99685 17.8347 3.82534 17.2402 3.48276L16.7464 3.1982C16.1536 2.85658 15.8571 2.68571 15.5423 2.62057C15.2639 2.56294 14.9765 2.56561 14.6991 2.62789C14.3859 2.69819 14.0931 2.87351 13.5079 3.22396L13.5045 3.22555L13.1507 3.43741C13.0948 3.47091 13.0665 3.48779 13.0384 3.50338C12.7601 3.6581 12.4495 3.74365 12.1312 3.75387C12.0992 3.7549 12.0665 3.7549 12.0013 3.7549C11.9365 3.7549 11.9024 3.7549 11.8704 3.75387C11.5515 3.74361 11.2402 3.65759 10.9615 3.50224C10.9334 3.48658 10.9056 3.46956 10.8496 3.4359L10.4935 3.22213C9.90422 2.86836 9.60915 2.69121 9.29427 2.62057C9.0157 2.55807 8.72737 2.55634 8.44791 2.61471C8.13236 2.68062 7.83577 2.85276 7.24258 3.19703L7.23994 3.1982L6.75228 3.48124L6.74688 3.48454C6.15904 3.82572 5.86441 3.99672 5.6517 4.23614C5.46294 4.4486 5.32185 4.69881 5.2374 4.97018C5.14194 5.27691 5.14703 5.61896 5.15853 6.3027L5.16568 6.72736C5.16676 6.79166 5.16864 6.82362 5.16817 6.85525C5.16343 7.17499 5.08086 7.48914 4.92974 7.77096C4.9148 7.79883 4.8987 7.8267 4.86654 7.88237C4.83436 7.93809 4.81877 7.96579 4.80209 7.99268C4.63336 8.26452 4.40214 8.49186 4.12733 8.65572C4.10015 8.67193 4.0715 8.68752 4.01521 8.71871L3.65365 8.91908C3.05208 9.25245 2.75137 9.41928 2.53256 9.65669C2.33898 9.86672 2.19275 10.1158 2.10349 10.3872C2.00259 10.6939 2.00267 11.0378 2.00424 11.7255L2.00551 12.2877C2.00706 12.9708 2.00919 13.3122 2.11032 13.6168C2.19979 13.8863 2.34495 14.134 2.53744 14.3427C2.75502 14.5787 3.05274 14.7445 3.64974 15.0766L4.00808 15.276C4.06907 15.3099 4.09976 15.3266 4.12917 15.3444C4.40148 15.5083 4.63089 15.735 4.79818 16.0053C4.81625 16.0345 4.8336 16.0648 4.8683 16.1255C4.90256 16.1853 4.92009 16.2152 4.93594 16.2452C5.08261 16.5229 5.16114 16.8315 5.16649 17.1455C5.16707 17.1794 5.16658 17.2137 5.16541 17.2827L5.15853 17.6902C5.14695 18.3763 5.1419 18.7197 5.23792 19.0273C5.32287 19.2994 5.46484 19.55 5.65463 19.7627C5.86915 20.0031 6.16655 20.1745 6.76107 20.5171L7.25478 20.8015C7.84763 21.1432 8.14395 21.3138 8.45869 21.379C8.73714 21.4366 9.02464 21.4344 9.30209 21.3721C9.61567 21.3017 9.90948 21.1258 10.4964 20.7743L10.8502 20.5625C10.9062 20.5289 10.9346 20.5121 10.9626 20.4965C11.2409 20.3418 11.5512 20.2558 11.8695 20.2456C11.9015 20.2446 11.9342 20.2446 11.9994 20.2446C12.0648 20.2446 12.0974 20.2446 12.1295 20.2456C12.4484 20.2559 12.7607 20.3422 13.0394 20.4975C13.0639 20.5112 13.0885 20.526 13.1316 20.5519L13.5078 20.7777C14.0971 21.1315 14.3916 21.3081 14.7065 21.3788C14.985 21.4413 15.2736 21.4438 15.5531 21.3855C15.8685 21.3196 16.1657 21.1471 16.7586 20.803L17.2536 20.5157C17.8418 20.1743 18.1367 20.0031 18.3495 19.7636C18.5383 19.5512 18.6796 19.3011 18.764 19.0297C18.8588 18.7252 18.8531 18.3858 18.8417 17.7119L18.8343 17.2724C18.8332 17.2081 18.8331 17.1761 18.8336 17.1445C18.8383 16.8247 18.9195 16.5104 19.0706 16.2286C19.0856 16.2007 19.1018 16.1726 19.1338 16.1171C19.166 16.0615 19.1827 16.0337 19.1994 16.0068C19.3681 15.7349 19.5995 15.5074 19.8744 15.3435C19.9012 15.3275 19.9289 15.3122 19.9838 15.2818L19.9857 15.2809L20.3472 15.0805C20.9488 14.7472 21.2501 14.5801 21.4689 14.3427C21.6625 14.1327 21.8085 13.8839 21.8978 13.6126C21.9981 13.3077 21.9973 12.9658 21.9958 12.2861L21.9945 11.7119C21.9929 11.0287 21.9921 10.6874 21.891 10.3828C21.8015 10.1133 21.6555 9.86561 21.463 9.65685C21.2457 9.42111 20.9475 9.25526 20.3517 8.92378L20.3499 8.92293Z","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M8.00033 12C8.00033 14.2091 9.79119 16 12.0003 16C14.2095 16 16.0003 14.2091 16.0003 12C16.0003 9.79082 14.2095 7.99996 12.0003 7.99996C9.79119 7.99996 8.00033 9.79082 8.00033 12Z","stroke","#000000","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"set-info","col-center"],["fill-rule","evenodd","clip-rule","evenodd","d","M5.46484 3.92349C4.79896 3.5739 4 4.05683 4 4.80888V19.1911C4 19.9432 4.79896 20.4261 5.46483 20.0765L19.1622 12.8854C19.8758 12.5108 19.8758 11.4892 19.1622 11.1146L5.46484 3.92349ZM2 4.80888C2 2.55271 4.3969 1.10395 6.39451 2.15269L20.0919 9.34382C22.2326 10.4677 22.2325 13.5324 20.0919 14.6562L6.3945 21.8473C4.39689 22.8961 2 21.4473 2 19.1911V4.80888Z","fill","#000000"]],template:function(r,s){r&1&&I(0,su,1,0,"app-loading")(1,lu,17,2),r&2&&ne(s.loading?0:1)},dependencies:[X,Z,pe,Dt,$e,ga],styles:["body[_ngcontent-%COMP%]{margin:0;background:#dedede;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:2.5rem;margin:0 .5rem;padding:.25rem;border:none;outline:none;border-radius:5px;background-color:#f0f8ff;font-size:large;font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}textarea[_ngcontent-%COMP%]{height:3.5rem}button[_ngcontent-%COMP%]{font-family:Gill Sans,Gill Sans MT,Calibri,Trebuchet MS,sans-serif}.label[_ngcontent-%COMP%]{font-size:20px}.btn[_ngcontent-%COMP%]{width:fit-content;margin:auto;padding:.5rem 1rem;border:none;outline:none;height:3rem;border-radius:5px;font-size:20px;box-shadow:0 1px 2px #d3d3d3}.submit[_ngcontent-%COMP%]{background-color:#90ee90}.cancel[_ngcontent-%COMP%]{background-color:#f08080}.icon-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;outline:none;border:none;background:none;width:4rem;height:4rem;padding:0 .5rem}.icon-btn[_ngcontent-%COMP%]:hover{cursor:pointer;outline:solid 1px black}.navbar[_ngcontent-%COMP%]{height:4rem;width:100%;display:flex;flex-direction:row;justify-content:space-between}.border-input[_ngcontent-%COMP%]{background:#ffffff10;border:solid 1px black}.list[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;padding:1rem;gap:.5rem}.list-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:10px;box-shadow:0 1px 2px gray;font-size:32px;padding:1rem;gap:.5rem}.col-center[_ngcontent-%COMP%]{height:auto;display:flex;flex-direction:column;justify-content:center}.row-between[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.color-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;flex-wrap:wrap;gap:.5rem;margin:1rem auto}[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;margin:auto;width:100%;height:100%}a[_ngcontent-%COMP%]{text-decoration:none;color:#000}.grid[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:repeat(4,1fr);grid-auto-rows:1fr;overflow-x:hidden;overflow-y:auto}.set[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.set-card[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:space-between;text-align:left;border-radius:4px;box-shadow:0 1px 2px gray;font-size:32px;gap:.5rem;margin:.5rem;padding:1rem .25rem}.set-title[_ngcontent-%COMP%]{margin:0 .5rem;word-break:normal;text-align:center}.set-info[_ngcontent-%COMP%]{font-size:26px;text-align:center}@media (max-width: 1500px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 800px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 525px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(1,1fr)}}"]});let n=e;return n})();var _f=[{path:"",component:ma,canActivate:[me],children:[{path:"",component:_a,canActivate:[me]},{path:"deck",component:Vr,canActivate:[me]},{path:"deck/set/:setId",component:Vr,pathMatch:"full",canActivate:[me]},{path:"list",component:jr,canActivate:[me]},{path:"list/set/:setId",component:jr,pathMatch:"full",canActivate:[me]},{path:"sets",component:Ca,canActivate:[me]}]}];export{_f as routes};
